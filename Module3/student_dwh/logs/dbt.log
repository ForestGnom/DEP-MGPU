[0m23:56:31.554589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46d8fbd780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46d7f74250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46d7f741f0>]}


============================== 23:56:31.565629 | f9e37df9-cf91-4791-b21f-45fc7a2548b7 ==============================
[0m23:56:31.565629 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:56:31.568989 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'target_path': 'None', 'profiles_dir': '/home/dev/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'quiet': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'introspect': 'True', 'version_check': 'True', 'empty': 'False', 'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False'}
[0m23:56:32.623101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9e37df9-cf91-4791-b21f-45fc7a2548b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46d8e434f0>]}
[0m23:56:33.298990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9e37df9-cf91-4791-b21f-45fc7a2548b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46d7f453f0>]}
[0m23:56:33.305177 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:56:33.921837 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:56:33.923936 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:56:33.927218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f9e37df9-cf91-4791-b21f-45fc7a2548b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46d7e536a0>]}
[0m23:56:40.602054 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.student_dwh.example
[0m23:56:40.661011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9e37df9-cf91-4791-b21f-45fc7a2548b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46d517c130>]}
[0m23:56:41.492094 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m23:56:41.500098 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m23:56:41.565183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9e37df9-cf91-4791-b21f-45fc7a2548b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46d517efb0>]}
[0m23:56:41.570235 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m23:56:41.574182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9e37df9-cf91-4791-b21f-45fc7a2548b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46d5bd62f0>]}
[0m23:56:41.591543 [info ] [MainThread]: 
[0m23:56:41.599387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:56:41.607884 [info ] [MainThread]: 
[0m23:56:41.616898 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:41.666306 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m23:56:41.872844 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m23:56:41.875874 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m23:56:41.879051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:41.920616 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "192.168.31.248", port 5432 failed: FATAL:  password authentication failed for user "admin@admin.com"

[0m23:56:41.960278 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m23:56:41.962631 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:56:41.965037 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m23:56:41.966988 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:56:41.971468 [debug] [ThreadPool]: On list_superstore: No close available on handle
[0m23:56:41.981768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:41.991586 [debug] [MainThread]: Connection 'list_superstore' was properly closed.
[0m23:56:42.002748 [info ] [MainThread]: 
[0m23:56:42.016042 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:56:42.025810 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "192.168.31.248", port 5432 failed: FATAL:  password authentication failed for user "admin@admin.com"
  
[0m23:56:42.040134 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.7193365, "process_in_blocks": "384", "process_kernel_time": 0.78421, "process_mem_max_rss": "121756", "process_out_blocks": "1856", "process_user_time": 15.350726}
[0m23:56:42.047930 [debug] [MainThread]: Command `dbt run` failed at 23:56:42.047079 after 10.73 seconds
[0m23:56:42.054968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46d8fbd780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46d5bd4c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a46d51b36d0>]}
[0m23:56:42.069063 [debug] [MainThread]: Flushing usage events
[0m23:56:46.970373 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:06.164320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f44c745750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f44b6d8220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f44b6d81c0>]}


============================== 00:16:06.171780 | 25713d2a-ad4e-46ea-b35c-4d8272561a0d ==============================
[0m00:16:06.171780 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:16:06.173675 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'empty': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'profiles_dir': '/home/dev/.dbt', 'no_print': 'None', 'static_parser': 'True', 'use_colors': 'True'}
[0m00:16:06.186674 [info ] [MainThread]: dbt version: 1.10.11
[0m00:16:06.188222 [info ] [MainThread]: python version: 3.10.12
[0m00:16:06.189592 [info ] [MainThread]: python path: /home/dev/Downloads/pde_magistr/dbt-env/bin/python3
[0m00:16:06.190730 [info ] [MainThread]: os info: Linux-6.8.0-85-generic-x86_64-with-glibc2.35
[0m00:16:06.276410 [info ] [MainThread]: Using profiles dir at /home/dev/.dbt
[0m00:16:06.277515 [info ] [MainThread]: Using profiles.yml file at /home/dev/.dbt/profiles.yml
[0m00:16:06.278274 [info ] [MainThread]: Using dbt_project.yml file at /home/dev/Downloads/pde_magistr/student_dwh/dbt_project.yml
[0m00:16:06.279638 [info ] [MainThread]: adapter type: postgres
[0m00:16:06.280520 [info ] [MainThread]: adapter version: 1.9.1
[0m00:16:06.451004 [info ] [MainThread]: Configuration:
[0m00:16:06.453021 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:16:06.455391 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:16:06.456277 [info ] [MainThread]: Required dependencies:
[0m00:16:06.457660 [debug] [MainThread]: Executing "git --help"
[0m00:16:06.463098 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:16:06.463943 [debug] [MainThread]: STDERR: "b''"
[0m00:16:06.464897 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:16:06.466174 [info ] [MainThread]: Connection:
[0m00:16:06.467036 [info ] [MainThread]:   host: 192.168.31.248
[0m00:16:06.467939 [info ] [MainThread]:   port: 5432
[0m00:16:06.468737 [info ] [MainThread]:   user: admin@admin.com
[0m00:16:06.469675 [info ] [MainThread]:   database: superstore
[0m00:16:06.470421 [info ] [MainThread]:   schema: dw_student
[0m00:16:06.471512 [info ] [MainThread]:   connect_timeout: 10
[0m00:16:06.472654 [info ] [MainThread]:   role: None
[0m00:16:06.473427 [info ] [MainThread]:   search_path: None
[0m00:16:06.474081 [info ] [MainThread]:   keepalives_idle: 0
[0m00:16:06.474972 [info ] [MainThread]:   sslmode: None
[0m00:16:06.476209 [info ] [MainThread]:   sslcert: None
[0m00:16:06.477619 [info ] [MainThread]:   sslkey: None
[0m00:16:06.478369 [info ] [MainThread]:   sslrootcert: None
[0m00:16:06.479091 [info ] [MainThread]:   application_name: dbt
[0m00:16:06.479810 [info ] [MainThread]:   retries: 1
[0m00:16:06.480799 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:16:06.586563 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:16:06.623071 [debug] [MainThread]: Using postgres connection "debug"
[0m00:16:06.624049 [debug] [MainThread]: On debug: select 1 as id
[0m00:16:06.624799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:06.654599 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "192.168.31.248", port 5432 failed: FATAL:  password authentication failed for user "admin@admin.com"

[0m00:16:06.670432 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m00:16:06.671266 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m00:16:06.674317 [debug] [MainThread]: On debug: No close available on handle
[0m00:16:06.675290 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m00:16:06.680146 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:16:06.683493 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "192.168.31.248", port 5432 failed: FATAL:  password authentication failed for user "admin@admin.com"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m00:16:06.687637 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5892073, "process_in_blocks": "2064", "process_kernel_time": 0.193106, "process_mem_max_rss": "108500", "process_out_blocks": "24", "process_user_time": 2.240237}
[0m00:16:06.688553 [debug] [MainThread]: Command `dbt debug` failed at 00:16:06.688371 after 0.59 seconds
[0m00:16:06.689360 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:16:06.690116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f44c745750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f44b62d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f44c6438e0>]}
[0m00:16:06.691139 [debug] [MainThread]: Flushing usage events
[0m00:16:07.335398 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:26:53.758932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8a962ad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8a95260bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8a95260b50>]}


============================== 00:26:53.762770 | 7e6c2220-511f-4919-ba54-f1a04fe47a63 ==============================
[0m00:26:53.762770 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:26:53.763429 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt debug', 'debug': 'False', 'printer_width': '80', 'empty': 'None', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/dev/.dbt'}
[0m00:26:53.771581 [info ] [MainThread]: dbt version: 1.10.11
[0m00:26:53.772337 [info ] [MainThread]: python version: 3.10.12
[0m00:26:53.772734 [info ] [MainThread]: python path: /home/dev/Downloads/pde_magistr/dbt-env/bin/python3
[0m00:26:53.773097 [info ] [MainThread]: os info: Linux-6.8.0-85-generic-x86_64-with-glibc2.35
[0m00:26:53.854825 [info ] [MainThread]: Using profiles dir at /home/dev/.dbt
[0m00:26:53.856117 [info ] [MainThread]: Using profiles.yml file at /home/dev/.dbt/profiles.yml
[0m00:26:53.856927 [info ] [MainThread]: Using dbt_project.yml file at /home/dev/Downloads/pde_magistr/student_dwh/dbt_project.yml
[0m00:26:53.857887 [info ] [MainThread]: adapter type: postgres
[0m00:26:53.858683 [info ] [MainThread]: adapter version: 1.9.1
[0m00:26:54.011722 [info ] [MainThread]: Configuration:
[0m00:26:54.013224 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:26:54.014169 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:26:54.015115 [info ] [MainThread]: Required dependencies:
[0m00:26:54.016181 [debug] [MainThread]: Executing "git --help"
[0m00:26:54.022545 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:26:54.023250 [debug] [MainThread]: STDERR: "b''"
[0m00:26:54.023798 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:26:54.024676 [info ] [MainThread]: Connection:
[0m00:26:54.025416 [info ] [MainThread]:   host: 192.168.31.248
[0m00:26:54.026044 [info ] [MainThread]:   port: 5432
[0m00:26:54.026738 [info ] [MainThread]:   user: admin@admin.com
[0m00:26:54.027264 [info ] [MainThread]:   database: superstore
[0m00:26:54.027867 [info ] [MainThread]:   schema: dw_student
[0m00:26:54.028439 [info ] [MainThread]:   connect_timeout: 10
[0m00:26:54.029110 [info ] [MainThread]:   role: None
[0m00:26:54.030198 [info ] [MainThread]:   search_path: None
[0m00:26:54.030977 [info ] [MainThread]:   keepalives_idle: 0
[0m00:26:54.032025 [info ] [MainThread]:   sslmode: None
[0m00:26:54.033362 [info ] [MainThread]:   sslcert: None
[0m00:26:54.034518 [info ] [MainThread]:   sslkey: None
[0m00:26:54.035970 [info ] [MainThread]:   sslrootcert: None
[0m00:26:54.037506 [info ] [MainThread]:   application_name: dbt
[0m00:26:54.038565 [info ] [MainThread]:   retries: 1
[0m00:26:54.039796 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:26:54.286021 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:26:54.340039 [debug] [MainThread]: Using postgres connection "debug"
[0m00:26:54.341105 [debug] [MainThread]: On debug: select 1 as id
[0m00:26:54.341916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:26:54.364824 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "192.168.31.248", port 5432 failed: FATAL:  password authentication failed for user "admin@admin.com"

[0m00:26:54.373192 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m00:26:54.374234 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m00:26:54.375285 [debug] [MainThread]: On debug: No close available on handle
[0m00:26:54.375925 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m00:26:54.376652 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:26:54.377387 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "192.168.31.248", port 5432 failed: FATAL:  password authentication failed for user "admin@admin.com"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m00:26:54.378775 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.69901055, "process_in_blocks": "0", "process_kernel_time": 0.207452, "process_mem_max_rss": "108256", "process_out_blocks": "24", "process_user_time": 2.003709}
[0m00:26:54.379502 [debug] [MainThread]: Command `dbt debug` failed at 00:26:54.379377 after 0.70 seconds
[0m00:26:54.380184 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:26:54.380780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8a962ad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8a94b37eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8a952041f0>]}
[0m00:26:54.381362 [debug] [MainThread]: Flushing usage events
[0m00:26:55.063172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:28:07.310994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e00bead7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e00ae60bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e00ae60b50>]}


============================== 00:28:07.314451 | 25f9b0f7-3d8c-4467-baaf-c4b9c292c47d ==============================
[0m00:28:07.314451 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:28:07.315192 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'introspect': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/dev/.dbt', 'log_format': 'default', 'static_parser': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None'}
[0m00:28:07.325168 [info ] [MainThread]: dbt version: 1.10.11
[0m00:28:07.326347 [info ] [MainThread]: python version: 3.10.12
[0m00:28:07.327242 [info ] [MainThread]: python path: /home/dev/Downloads/pde_magistr/dbt-env/bin/python3
[0m00:28:07.328006 [info ] [MainThread]: os info: Linux-6.8.0-85-generic-x86_64-with-glibc2.35
[0m00:28:07.421711 [info ] [MainThread]: Using profiles dir at /home/dev/.dbt
[0m00:28:07.423549 [info ] [MainThread]: Using profiles.yml file at /home/dev/.dbt/profiles.yml
[0m00:28:07.424655 [info ] [MainThread]: Using dbt_project.yml file at /home/dev/Downloads/pde_magistr/student_dwh/dbt_project.yml
[0m00:28:07.425923 [info ] [MainThread]: adapter type: postgres
[0m00:28:07.427010 [info ] [MainThread]: adapter version: 1.9.1
[0m00:28:07.597732 [info ] [MainThread]: Configuration:
[0m00:28:07.599026 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:28:07.599915 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:28:07.600576 [info ] [MainThread]: Required dependencies:
[0m00:28:07.601150 [debug] [MainThread]: Executing "git --help"
[0m00:28:07.605058 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:28:07.606611 [debug] [MainThread]: STDERR: "b''"
[0m00:28:07.607760 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:28:07.610370 [info ] [MainThread]: Connection:
[0m00:28:07.613457 [info ] [MainThread]:   host: 192.168.31.248
[0m00:28:07.614818 [info ] [MainThread]:   port: 5432
[0m00:28:07.616856 [info ] [MainThread]:   user: admin
[0m00:28:07.618669 [info ] [MainThread]:   database: superstore
[0m00:28:07.620160 [info ] [MainThread]:   schema: dw_student
[0m00:28:07.621235 [info ] [MainThread]:   connect_timeout: 10
[0m00:28:07.622228 [info ] [MainThread]:   role: None
[0m00:28:07.623173 [info ] [MainThread]:   search_path: None
[0m00:28:07.624193 [info ] [MainThread]:   keepalives_idle: 0
[0m00:28:07.625218 [info ] [MainThread]:   sslmode: None
[0m00:28:07.626210 [info ] [MainThread]:   sslcert: None
[0m00:28:07.627016 [info ] [MainThread]:   sslkey: None
[0m00:28:07.627851 [info ] [MainThread]:   sslrootcert: None
[0m00:28:07.628606 [info ] [MainThread]:   application_name: dbt
[0m00:28:07.629390 [info ] [MainThread]:   retries: 1
[0m00:28:07.630609 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:28:07.768422 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:28:07.802608 [debug] [MainThread]: Using postgres connection "debug"
[0m00:28:07.803757 [debug] [MainThread]: On debug: select 1 as id
[0m00:28:07.804821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:28:07.818647 [debug] [MainThread]: SQL status: SELECT 1 in 0.014 seconds
[0m00:28:07.820187 [debug] [MainThread]: On debug: Close
[0m00:28:07.820910 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:28:07.821964 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:28:07.823610 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6241442, "process_in_blocks": "0", "process_kernel_time": 0.193862, "process_mem_max_rss": "108304", "process_out_blocks": "24", "process_user_time": 2.097795}
[0m00:28:07.824298 [debug] [MainThread]: Command `dbt debug` succeeded at 00:28:07.824188 after 0.63 seconds
[0m00:28:07.824811 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:28:07.825324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e00bead7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e00ae60af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e00a737eb0>]}
[0m00:28:07.825901 [debug] [MainThread]: Flushing usage events
[0m00:28:08.482283 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:28:52.080216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2f681810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2e60c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2e60c1c0>]}


============================== 00:28:52.084248 | 7f687464-4151-4d96-ba2d-aa5b4222593c ==============================
[0m00:28:52.084248 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:28:52.085281 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'write_json': 'True', 'debug': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'profiles_dir': '/home/dev/.dbt', 'use_colors': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'printer_width': '80', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'log_cache_events': 'False'}
[0m00:28:52.379443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e310ca020>]}
[0m00:28:52.495196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2df56f50>]}
[0m00:28:52.496477 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:28:52.687700 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:28:52.854035 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:28:52.856586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2ee0bd30>]}
[0m00:28:54.549780 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.student_dwh.example
[0m00:28:54.562259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2b887dc0>]}
[0m00:28:54.761902 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m00:28:54.765266 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m00:28:54.796192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2c7e9240>]}
[0m00:28:54.797763 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m00:28:54.799050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2c7e96f0>]}
[0m00:28:54.803811 [info ] [MainThread]: 
[0m00:28:54.804938 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:28:54.805772 [info ] [MainThread]: 
[0m00:28:54.806703 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:28:54.825170 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m00:28:54.926739 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m00:28:54.932115 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m00:28:54.933124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:54.969627 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.036 seconds
[0m00:28:54.974002 [debug] [ThreadPool]: On list_superstore: Close
[0m00:28:54.982695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_dw_student)
[0m00:28:54.996917 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m00:28:54.997973 [debug] [ThreadPool]: On list_superstore_dw_student: BEGIN
[0m00:28:54.998784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:55.008568 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m00:28:55.009548 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m00:28:55.010228 [debug] [ThreadPool]: On list_superstore_dw_student: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_student"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_student'
  
[0m00:28:55.016751 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m00:28:55.018904 [debug] [ThreadPool]: On list_superstore_dw_student: ROLLBACK
[0m00:28:55.022576 [debug] [ThreadPool]: On list_superstore_dw_student: Close
[0m00:28:55.042533 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:55.043941 [debug] [MainThread]: On master: BEGIN
[0m00:28:55.044986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:28:55.061801 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m00:28:55.062732 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:55.063817 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:28:55.069492 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m00:28:55.073201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e30383d00>]}
[0m00:28:55.074937 [debug] [MainThread]: On master: ROLLBACK
[0m00:28:55.077042 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:55.078416 [debug] [MainThread]: On master: BEGIN
[0m00:28:55.080044 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:28:55.080536 [debug] [MainThread]: On master: COMMIT
[0m00:28:55.081840 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:55.083060 [debug] [MainThread]: On master: COMMIT
[0m00:28:55.084621 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:28:55.085206 [debug] [MainThread]: On master: Close
[0m00:28:55.092093 [debug] [Thread-1 (]: Began running node model.student_dwh.calendar_dim
[0m00:28:55.092986 [info ] [Thread-1 (]: 1 of 7 START sql view model dw_student.calendar_dim ............................ [RUN]
[0m00:28:55.093996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_student, now model.student_dwh.calendar_dim)
[0m00:28:55.094660 [debug] [Thread-1 (]: Began compiling node model.student_dwh.calendar_dim
[0m00:28:55.105146 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.calendar_dim"
[0m00:28:55.106261 [debug] [Thread-1 (]: Began executing node model.student_dwh.calendar_dim
[0m00:28:55.189085 [debug] [Thread-1 (]: Writing runtime sql for node "model.student_dwh.calendar_dim"
[0m00:28:55.190852 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.calendar_dim"
[0m00:28:55.191984 [debug] [Thread-1 (]: On model.student_dwh.calendar_dim: BEGIN
[0m00:28:55.192782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:55.208978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m00:28:55.210001 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.calendar_dim"
[0m00:28:55.211279 [debug] [Thread-1 (]: On model.student_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.calendar_dim"} */

  create view "superstore"."dw_student"."calendar_dim__dbt_tmp"
    
    
  as (
    -- Создает таблицу-календарь
SELECT
    to_char(date,'yyyymmdd')::int as dateid,
    extract('year' from date)::int as year,
    extract('quarter' from date)::int as quarter,
    extract('month' from date)::int as month,
    extract('week' from date)::int as week,
    date::date,
    to_char(date, 'dy') as week_day,
    -- Проверка на високосный год
    CASE
        WHEN extract('day' from (date + interval '2 month - 1 day')) = 29 THEN 'leap'
        ELSE 'not leap'
    END as leap
FROM generate_series(
    date '2010-01-01',
    date '2030-12-31',
    interval '1 day'
) AS t(date)
  );
[0m00:28:55.221696 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m00:28:55.229035 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.calendar_dim"
[0m00:28:55.230005 [debug] [Thread-1 (]: On model.student_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.calendar_dim"} */
alter table "superstore"."dw_student"."calendar_dim__dbt_tmp" rename to "calendar_dim"
[0m00:28:55.232122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:28:55.251907 [debug] [Thread-1 (]: On model.student_dwh.calendar_dim: COMMIT
[0m00:28:55.253623 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.calendar_dim"
[0m00:28:55.254818 [debug] [Thread-1 (]: On model.student_dwh.calendar_dim: COMMIT
[0m00:28:55.260087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m00:28:55.277111 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_student"."calendar_dim__dbt_backup"
[0m00:28:55.290662 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.calendar_dim"
[0m00:28:55.292532 [debug] [Thread-1 (]: On model.student_dwh.calendar_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.calendar_dim"} */
drop view if exists "superstore"."dw_student"."calendar_dim__dbt_backup" cascade
[0m00:28:55.293833 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:28:55.301387 [debug] [Thread-1 (]: On model.student_dwh.calendar_dim: Close
[0m00:28:55.306796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e30e44b80>]}
[0m00:28:55.307911 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dw_student.calendar_dim ....................... [[32mCREATE VIEW[0m in 0.21s]
[0m00:28:55.308878 [debug] [Thread-1 (]: Finished running node model.student_dwh.calendar_dim
[0m00:28:55.309482 [debug] [Thread-1 (]: Began running node model.student_dwh.stg_orders
[0m00:28:55.310177 [info ] [Thread-1 (]: 2 of 7 START sql view model dw_student.stg_orders .............................. [RUN]
[0m00:28:55.310983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.calendar_dim, now model.student_dwh.stg_orders)
[0m00:28:55.311534 [debug] [Thread-1 (]: Began compiling node model.student_dwh.stg_orders
[0m00:28:55.316530 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.stg_orders"
[0m00:28:55.318951 [debug] [Thread-1 (]: Began executing node model.student_dwh.stg_orders
[0m00:28:55.334031 [debug] [Thread-1 (]: Writing runtime sql for node "model.student_dwh.stg_orders"
[0m00:28:55.336529 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.stg_orders"
[0m00:28:55.338163 [debug] [Thread-1 (]: On model.student_dwh.stg_orders: BEGIN
[0m00:28:55.339954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:55.370401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m00:28:55.372231 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.stg_orders"
[0m00:28:55.373522 [debug] [Thread-1 (]: On model.student_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.stg_orders"} */

  create view "superstore"."dw_student"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
-- Эта модель читает данные из исходной таблицы stg.orders,
-- приводит их к нужным типам и исправляет ошибку с почтовым кодом.
-- Все последующие модели будут ссылаться на эту, а не на исходную таблицу.

SELECT
    -- Приводим все к нижнему регистру для консистентности в dbt
    "order_id",
    ("order_date")::date as order_date,
    ("ship_date")::date as ship_date,
    "ship_mode",
    "customer_id",
    "customer_name",
    "segment",
    "country",
    "city",
    "state",
    -- Исправляем проблему с Burlington прямо здесь, один раз и навсегда
    CASE
        WHEN "city" = 'Burlington' AND "postal_code" IS NULL THEN '05401'
        ELSE "postal_code"
    END as postal_code,
    "region",
    "product_id",
    "category",
    "subcategory" as sub_category, -- переименовываем для соответствия
    "product_name",
    "sales",
    "quantity",
    "discount",
    "profit"
FROM "superstore"."stg"."orders"
  );
[0m00:28:55.379747 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m00:28:55.385029 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.stg_orders"
[0m00:28:55.385695 [debug] [Thread-1 (]: On model.student_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.stg_orders"} */
alter table "superstore"."dw_student"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m00:28:55.386706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:28:55.388198 [debug] [Thread-1 (]: On model.student_dwh.stg_orders: COMMIT
[0m00:28:55.388774 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.stg_orders"
[0m00:28:55.389209 [debug] [Thread-1 (]: On model.student_dwh.stg_orders: COMMIT
[0m00:28:55.390989 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:28:55.393944 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_student"."stg_orders__dbt_backup"
[0m00:28:55.394783 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.stg_orders"
[0m00:28:55.395277 [debug] [Thread-1 (]: On model.student_dwh.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.stg_orders"} */
drop view if exists "superstore"."dw_student"."stg_orders__dbt_backup" cascade
[0m00:28:55.396055 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:28:55.397670 [debug] [Thread-1 (]: On model.student_dwh.stg_orders: Close
[0m00:28:55.398589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2cb14130>]}
[0m00:28:55.399456 [info ] [Thread-1 (]: 2 of 7 OK created sql view model dw_student.stg_orders ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m00:28:55.402683 [debug] [Thread-1 (]: Finished running node model.student_dwh.stg_orders
[0m00:28:55.404524 [debug] [Thread-1 (]: Began running node model.student_dwh.customer_dim
[0m00:28:55.405664 [info ] [Thread-1 (]: 3 of 7 START sql view model dw_student.customer_dim ............................ [RUN]
[0m00:28:55.406708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.stg_orders, now model.student_dwh.customer_dim)
[0m00:28:55.407451 [debug] [Thread-1 (]: Began compiling node model.student_dwh.customer_dim
[0m00:28:55.412167 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.customer_dim"
[0m00:28:55.413804 [debug] [Thread-1 (]: Began executing node model.student_dwh.customer_dim
[0m00:28:55.420905 [debug] [Thread-1 (]: Writing runtime sql for node "model.student_dwh.customer_dim"
[0m00:28:55.422356 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.customer_dim"
[0m00:28:55.423128 [debug] [Thread-1 (]: On model.student_dwh.customer_dim: BEGIN
[0m00:28:55.423828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:55.434213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:28:55.435369 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.customer_dim"
[0m00:28:55.436310 [debug] [Thread-1 (]: On model.student_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.customer_dim"} */

  create view "superstore"."dw_student"."customer_dim__dbt_tmp"
    
    
  as (
    -- Создает справочник клиентов
SELECT
    100 + row_number() OVER (ORDER BY "customer_id") as cust_id,
    "customer_id",
    "customer_name"
FROM (
    SELECT DISTINCT "customer_id", "customer_name" FROM "superstore"."dw_student"."stg_orders"
) as unique_customers
  );
[0m00:28:55.440660 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:28:55.447234 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.customer_dim"
[0m00:28:55.448121 [debug] [Thread-1 (]: On model.student_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.customer_dim"} */
alter table "superstore"."dw_student"."customer_dim__dbt_tmp" rename to "customer_dim"
[0m00:28:55.449532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:28:55.452574 [debug] [Thread-1 (]: On model.student_dwh.customer_dim: COMMIT
[0m00:28:55.453459 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.customer_dim"
[0m00:28:55.454180 [debug] [Thread-1 (]: On model.student_dwh.customer_dim: COMMIT
[0m00:28:55.456784 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m00:28:55.465372 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_student"."customer_dim__dbt_backup"
[0m00:28:55.469149 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.customer_dim"
[0m00:28:55.471367 [debug] [Thread-1 (]: On model.student_dwh.customer_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.customer_dim"} */
drop view if exists "superstore"."dw_student"."customer_dim__dbt_backup" cascade
[0m00:28:55.474610 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:28:55.479778 [debug] [Thread-1 (]: On model.student_dwh.customer_dim: Close
[0m00:28:55.486109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2b856ad0>]}
[0m00:28:55.489709 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dw_student.customer_dim ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m00:28:55.491646 [debug] [Thread-1 (]: Finished running node model.student_dwh.customer_dim
[0m00:28:55.492870 [debug] [Thread-1 (]: Began running node model.student_dwh.geo_dim
[0m00:28:55.494051 [info ] [Thread-1 (]: 4 of 7 START sql view model dw_student.geo_dim ................................. [RUN]
[0m00:28:55.496599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.customer_dim, now model.student_dwh.geo_dim)
[0m00:28:55.497549 [debug] [Thread-1 (]: Began compiling node model.student_dwh.geo_dim
[0m00:28:55.502560 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.geo_dim"
[0m00:28:55.503596 [debug] [Thread-1 (]: Began executing node model.student_dwh.geo_dim
[0m00:28:55.510219 [debug] [Thread-1 (]: Writing runtime sql for node "model.student_dwh.geo_dim"
[0m00:28:55.516632 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.geo_dim"
[0m00:28:55.518061 [debug] [Thread-1 (]: On model.student_dwh.geo_dim: BEGIN
[0m00:28:55.519379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:55.544877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m00:28:55.546017 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.geo_dim"
[0m00:28:55.548909 [debug] [Thread-1 (]: On model.student_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.geo_dim"} */

  create view "superstore"."dw_student"."geo_dim__dbt_tmp"
    
    
  as (
    -- Создает географический справочник
SELECT
    100 + row_number() OVER (ORDER BY "postal_code", "city", "state") as geo_id,
    "country",
    "city",
    "state",
    "postal_code"
FROM (
    SELECT DISTINCT "country", "city", "state", "postal_code" FROM "superstore"."dw_student"."stg_orders"
) as unique_geo
  );
[0m00:28:55.555848 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m00:28:55.566885 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.geo_dim"
[0m00:28:55.568188 [debug] [Thread-1 (]: On model.student_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.geo_dim"} */
alter table "superstore"."dw_student"."geo_dim__dbt_tmp" rename to "geo_dim"
[0m00:28:55.572208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:28:55.575496 [debug] [Thread-1 (]: On model.student_dwh.geo_dim: COMMIT
[0m00:28:55.578153 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.geo_dim"
[0m00:28:55.580718 [debug] [Thread-1 (]: On model.student_dwh.geo_dim: COMMIT
[0m00:28:55.583785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m00:28:55.594729 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_student"."geo_dim__dbt_backup"
[0m00:28:55.597878 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.geo_dim"
[0m00:28:55.599891 [debug] [Thread-1 (]: On model.student_dwh.geo_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.geo_dim"} */
drop view if exists "superstore"."dw_student"."geo_dim__dbt_backup" cascade
[0m00:28:55.602787 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:28:55.607141 [debug] [Thread-1 (]: On model.student_dwh.geo_dim: Close
[0m00:28:55.609580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2b8deec0>]}
[0m00:28:55.612783 [info ] [Thread-1 (]: 4 of 7 OK created sql view model dw_student.geo_dim ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m00:28:55.617530 [debug] [Thread-1 (]: Finished running node model.student_dwh.geo_dim
[0m00:28:55.619960 [debug] [Thread-1 (]: Began running node model.student_dwh.product_dim
[0m00:28:55.623735 [info ] [Thread-1 (]: 5 of 7 START sql view model dw_student.product_dim ............................. [RUN]
[0m00:28:55.628439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.geo_dim, now model.student_dwh.product_dim)
[0m00:28:55.630156 [debug] [Thread-1 (]: Began compiling node model.student_dwh.product_dim
[0m00:28:55.643930 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.product_dim"
[0m00:28:55.645431 [debug] [Thread-1 (]: Began executing node model.student_dwh.product_dim
[0m00:28:55.660062 [debug] [Thread-1 (]: Writing runtime sql for node "model.student_dwh.product_dim"
[0m00:28:55.663351 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.product_dim"
[0m00:28:55.666611 [debug] [Thread-1 (]: On model.student_dwh.product_dim: BEGIN
[0m00:28:55.667474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:55.685014 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m00:28:55.686763 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.product_dim"
[0m00:28:55.687282 [debug] [Thread-1 (]: On model.student_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.product_dim"} */

  create view "superstore"."dw_student"."product_dim__dbt_tmp"
    
    
  as (
    -- Создает справочник продуктов
SELECT
    100 + row_number() OVER (ORDER BY "product_id") as prod_id,
    "product_id",
    "product_name",
    "category",
    "sub_category",
    "segment"
FROM (
    SELECT DISTINCT "product_id", "product_name", "category", "sub_category", "segment" FROM "superstore"."dw_student"."stg_orders"
) as unique_products
  );
[0m00:28:55.692376 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:28:55.702491 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.product_dim"
[0m00:28:55.705973 [debug] [Thread-1 (]: On model.student_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.product_dim"} */
alter table "superstore"."dw_student"."product_dim__dbt_tmp" rename to "product_dim"
[0m00:28:55.709336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:28:55.712912 [debug] [Thread-1 (]: On model.student_dwh.product_dim: COMMIT
[0m00:28:55.714493 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.product_dim"
[0m00:28:55.715900 [debug] [Thread-1 (]: On model.student_dwh.product_dim: COMMIT
[0m00:28:55.718563 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:28:55.724373 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_student"."product_dim__dbt_backup"
[0m00:28:55.727351 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.product_dim"
[0m00:28:55.728145 [debug] [Thread-1 (]: On model.student_dwh.product_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.product_dim"} */
drop view if exists "superstore"."dw_student"."product_dim__dbt_backup" cascade
[0m00:28:55.729413 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:28:55.732621 [debug] [Thread-1 (]: On model.student_dwh.product_dim: Close
[0m00:28:55.734580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2c30d780>]}
[0m00:28:55.739748 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dw_student.product_dim ........................ [[32mCREATE VIEW[0m in 0.11s]
[0m00:28:55.742153 [debug] [Thread-1 (]: Finished running node model.student_dwh.product_dim
[0m00:28:55.743524 [debug] [Thread-1 (]: Began running node model.student_dwh.shipping_dim
[0m00:28:55.744793 [info ] [Thread-1 (]: 6 of 7 START sql view model dw_student.shipping_dim ............................ [RUN]
[0m00:28:55.746200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.product_dim, now model.student_dwh.shipping_dim)
[0m00:28:55.747267 [debug] [Thread-1 (]: Began compiling node model.student_dwh.shipping_dim
[0m00:28:55.755846 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.shipping_dim"
[0m00:28:55.756806 [debug] [Thread-1 (]: Began executing node model.student_dwh.shipping_dim
[0m00:28:55.765110 [debug] [Thread-1 (]: Writing runtime sql for node "model.student_dwh.shipping_dim"
[0m00:28:55.766091 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.shipping_dim"
[0m00:28:55.766723 [debug] [Thread-1 (]: On model.student_dwh.shipping_dim: BEGIN
[0m00:28:55.767109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:55.778370 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:28:55.779218 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.shipping_dim"
[0m00:28:55.779870 [debug] [Thread-1 (]: On model.student_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.shipping_dim"} */

  create view "superstore"."dw_student"."shipping_dim__dbt_tmp"
    
    
  as (
    -- Создает справочник видов доставки
SELECT
    100 + row_number() OVER (ORDER BY "ship_mode") as ship_id,
    "ship_mode"
FROM (
    SELECT DISTINCT "ship_mode" FROM "superstore"."dw_student"."stg_orders"
) as unique_shipping_modes
  );
[0m00:28:55.782520 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m00:28:55.786857 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.shipping_dim"
[0m00:28:55.787610 [debug] [Thread-1 (]: On model.student_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.shipping_dim"} */
alter table "superstore"."dw_student"."shipping_dim__dbt_tmp" rename to "shipping_dim"
[0m00:28:55.789053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:28:55.793096 [debug] [Thread-1 (]: On model.student_dwh.shipping_dim: COMMIT
[0m00:28:55.794184 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.shipping_dim"
[0m00:28:55.794823 [debug] [Thread-1 (]: On model.student_dwh.shipping_dim: COMMIT
[0m00:28:55.796169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m00:28:55.799655 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_student"."shipping_dim__dbt_backup"
[0m00:28:55.800517 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.shipping_dim"
[0m00:28:55.801000 [debug] [Thread-1 (]: On model.student_dwh.shipping_dim: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.shipping_dim"} */
drop view if exists "superstore"."dw_student"."shipping_dim__dbt_backup" cascade
[0m00:28:55.801784 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:28:55.803414 [debug] [Thread-1 (]: On model.student_dwh.shipping_dim: Close
[0m00:28:55.804252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2cb21630>]}
[0m00:28:55.804917 [info ] [Thread-1 (]: 6 of 7 OK created sql view model dw_student.shipping_dim ....................... [[32mCREATE VIEW[0m in 0.06s]
[0m00:28:55.813183 [debug] [Thread-1 (]: Finished running node model.student_dwh.shipping_dim
[0m00:28:55.815395 [debug] [Thread-1 (]: Began running node model.student_dwh.sales_fact
[0m00:28:55.816167 [info ] [Thread-1 (]: 7 of 7 START sql view model dw_student.sales_fact .............................. [RUN]
[0m00:28:55.817013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.shipping_dim, now model.student_dwh.sales_fact)
[0m00:28:55.817573 [debug] [Thread-1 (]: Began compiling node model.student_dwh.sales_fact
[0m00:28:55.824846 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.sales_fact"
[0m00:28:55.826496 [debug] [Thread-1 (]: Began executing node model.student_dwh.sales_fact
[0m00:28:55.834553 [debug] [Thread-1 (]: Writing runtime sql for node "model.student_dwh.sales_fact"
[0m00:28:55.836347 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.sales_fact"
[0m00:28:55.837394 [debug] [Thread-1 (]: On model.student_dwh.sales_fact: BEGIN
[0m00:28:55.838175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:55.848038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:28:55.848831 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.sales_fact"
[0m00:28:55.849493 [debug] [Thread-1 (]: On model.student_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.sales_fact"} */

  create view "superstore"."dw_student"."sales_fact__dbt_tmp"
    
    
  as (
    -- Создает таблицу фактов, объединяя все измерения
SELECT
    -- Суррогатные ключи из измерений
    cd.cust_id,
    pd.prod_id,
    sd.ship_id,
    gd.geo_id,
    -- Ключи для календаря
    to_char(o.order_date, 'yyyymmdd')::int AS order_date_id,
    to_char(o.ship_date, 'yyyymmdd')::int AS ship_date_id,
    -- Бизнес-ключ и метрики
    o.order_id,
    o.sales,
    o.profit,
    o.quantity,
    o.discount
FROM "superstore"."dw_student"."stg_orders" AS o
LEFT JOIN "superstore"."dw_student"."customer_dim" AS cd ON o.customer_id = cd.customer_id
LEFT JOIN "superstore"."dw_student"."product_dim" AS pd ON o.product_id = pd.product_id
LEFT JOIN "superstore"."dw_student"."shipping_dim" AS sd ON o.ship_mode = sd.ship_mode
LEFT JOIN "superstore"."dw_student"."geo_dim" AS gd ON o.postal_code = gd.postal_code AND o.city = gd.city AND o.state = gd.state
  );
[0m00:28:55.855027 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m00:28:55.865714 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.sales_fact"
[0m00:28:55.867662 [debug] [Thread-1 (]: On model.student_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.sales_fact"} */
alter table "superstore"."dw_student"."sales_fact__dbt_tmp" rename to "sales_fact"
[0m00:28:55.869545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:28:55.872180 [debug] [Thread-1 (]: On model.student_dwh.sales_fact: COMMIT
[0m00:28:55.872763 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.sales_fact"
[0m00:28:55.873199 [debug] [Thread-1 (]: On model.student_dwh.sales_fact: COMMIT
[0m00:28:55.876801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m00:28:55.882192 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_student"."sales_fact__dbt_backup"
[0m00:28:55.883065 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.sales_fact"
[0m00:28:55.883646 [debug] [Thread-1 (]: On model.student_dwh.sales_fact: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.sales_fact"} */
drop view if exists "superstore"."dw_student"."sales_fact__dbt_backup" cascade
[0m00:28:55.884523 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:28:55.886724 [debug] [Thread-1 (]: On model.student_dwh.sales_fact: Close
[0m00:28:55.890811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f687464-4151-4d96-ba2d-aa5b4222593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2946f1c0>]}
[0m00:28:55.892628 [info ] [Thread-1 (]: 7 of 7 OK created sql view model dw_student.sales_fact ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m00:28:55.893682 [debug] [Thread-1 (]: Finished running node model.student_dwh.sales_fact
[0m00:28:55.895907 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:55.896652 [debug] [MainThread]: On master: BEGIN
[0m00:28:55.897266 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:28:55.912610 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m00:28:55.914002 [debug] [MainThread]: On master: COMMIT
[0m00:28:55.915334 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:55.915808 [debug] [MainThread]: On master: COMMIT
[0m00:28:55.916828 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:28:55.917260 [debug] [MainThread]: On master: Close
[0m00:28:55.921870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:55.923264 [debug] [MainThread]: Connection 'model.student_dwh.sales_fact' was properly closed.
[0m00:28:55.924355 [info ] [MainThread]: 
[0m00:28:55.925265 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m00:28:55.928172 [debug] [MainThread]: Command end result
[0m00:28:55.991388 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m00:28:55.994933 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m00:28:56.008423 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m00:28:56.009484 [info ] [MainThread]: 
[0m00:28:56.010562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:28:56.011508 [info ] [MainThread]: 
[0m00:28:56.012355 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m00:28:56.014164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.046466, "process_in_blocks": "432", "process_kernel_time": 0.289344, "process_mem_max_rss": "124048", "process_out_blocks": "2992", "process_user_time": 5.078139}
[0m00:28:56.015171 [debug] [MainThread]: Command `dbt run` succeeded at 00:28:56.014947 after 4.05 seconds
[0m00:28:56.016139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2f681810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e310ca020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708e2b869f00>]}
[0m00:28:56.017044 [debug] [MainThread]: Flushing usage events
[0m00:28:56.798018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:04.631538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b35494a9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b354845c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b354845c1c0>]}


============================== 00:29:04.634832 | 30718902-e1bd-4550-9718-f01b7f6e4749 ==============================
[0m00:29:04.634832 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:29:04.635705 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None', 'write_json': 'True', 'target_path': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'introspect': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'partial_parse': 'True', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '/home/dev/.dbt', 'printer_width': '80'}
[0m00:29:04.845281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30718902-e1bd-4550-9718-f01b7f6e4749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3548406080>]}
[0m00:29:04.975303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30718902-e1bd-4550-9718-f01b7f6e4749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b354845feb0>]}
[0m00:29:04.976553 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:29:05.103394 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:29:05.322933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:29:05.324020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:29:05.334386 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.student_dwh.example
[0m00:29:05.398247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30718902-e1bd-4550-9718-f01b7f6e4749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3546db4f70>]}
[0m00:29:05.555778 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m00:29:05.562585 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m00:29:05.703954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30718902-e1bd-4550-9718-f01b7f6e4749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b354833eb60>]}
[0m00:29:05.705022 [info ] [MainThread]: Found 7 models, 9 data tests, 1 source, 435 macros
[0m00:29:05.705813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30718902-e1bd-4550-9718-f01b7f6e4749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b354833d180>]}
[0m00:29:05.708916 [info ] [MainThread]: 
[0m00:29:05.709500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:29:05.709966 [info ] [MainThread]: 
[0m00:29:05.710763 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:29:05.720762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_student'
[0m00:29:05.784398 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m00:29:05.785156 [debug] [ThreadPool]: On list_superstore_dw_student: BEGIN
[0m00:29:05.785682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:05.795820 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m00:29:05.796669 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m00:29:05.797382 [debug] [ThreadPool]: On list_superstore_dw_student: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_student"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_student'
  
[0m00:29:05.800880 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m00:29:05.802707 [debug] [ThreadPool]: On list_superstore_dw_student: ROLLBACK
[0m00:29:05.803507 [debug] [ThreadPool]: On list_superstore_dw_student: Close
[0m00:29:05.811608 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:05.812429 [debug] [MainThread]: On master: BEGIN
[0m00:29:05.812937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:29:05.822319 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m00:29:05.822979 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:05.823483 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:29:05.827366 [debug] [MainThread]: SQL status: SELECT 13 in 0.003 seconds
[0m00:29:05.831044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30718902-e1bd-4550-9718-f01b7f6e4749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b354af61de0>]}
[0m00:29:05.831733 [debug] [MainThread]: On master: ROLLBACK
[0m00:29:05.832522 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:05.832957 [debug] [MainThread]: On master: BEGIN
[0m00:29:05.833700 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:29:05.834211 [debug] [MainThread]: On master: COMMIT
[0m00:29:05.834674 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:05.835029 [debug] [MainThread]: On master: COMMIT
[0m00:29:05.835701 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:29:05.836088 [debug] [MainThread]: On master: Close
[0m00:29:05.839361 [debug] [Thread-1 (]: Began running node test.student_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m00:29:05.840170 [info ] [Thread-1 (]: 1 of 9 START test not_null_customer_dim_cust_id ................................ [RUN]
[0m00:29:05.841221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_student, now test.student_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m00:29:05.841950 [debug] [Thread-1 (]: Began compiling node test.student_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m00:29:05.867197 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m00:29:05.868750 [debug] [Thread-1 (]: Began executing node test.student_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m00:29:05.901025 [debug] [Thread-1 (]: Writing runtime sql for node "test.student_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m00:29:05.902430 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m00:29:05.903045 [debug] [Thread-1 (]: On test.student_dwh.not_null_customer_dim_cust_id.cd86607a42: BEGIN
[0m00:29:05.903653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:05.916054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m00:29:05.917222 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m00:29:05.918131 [debug] [Thread-1 (]: On test.student_dwh.not_null_customer_dim_cust_id.cd86607a42: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "test.student_dwh.not_null_customer_dim_cust_id.cd86607a42"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cust_id
from "superstore"."dw_student"."customer_dim"
where cust_id is null



  
  
      
    ) dbt_internal_test
[0m00:29:05.932651 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m00:29:05.937431 [debug] [Thread-1 (]: On test.student_dwh.not_null_customer_dim_cust_id.cd86607a42: ROLLBACK
[0m00:29:05.938453 [debug] [Thread-1 (]: On test.student_dwh.not_null_customer_dim_cust_id.cd86607a42: Close
[0m00:29:05.939374 [info ] [Thread-1 (]: 1 of 9 PASS not_null_customer_dim_cust_id ...................................... [[32mPASS[0m in 0.10s]
[0m00:29:05.940269 [debug] [Thread-1 (]: Finished running node test.student_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m00:29:05.941215 [debug] [Thread-1 (]: Began running node test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m00:29:05.942855 [info ] [Thread-1 (]: 2 of 9 START test not_null_geo_dim_geo_id ...................................... [RUN]
[0m00:29:05.944940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m00:29:05.945920 [debug] [Thread-1 (]: Began compiling node test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m00:29:05.951225 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m00:29:05.952289 [debug] [Thread-1 (]: Began executing node test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m00:29:05.957478 [debug] [Thread-1 (]: Writing runtime sql for node "test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m00:29:05.959195 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m00:29:05.960898 [debug] [Thread-1 (]: On test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d: BEGIN
[0m00:29:05.961845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:05.969431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m00:29:05.970094 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m00:29:05.970571 [debug] [Thread-1 (]: On test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geo_id
from "superstore"."dw_student"."geo_dim"
where geo_id is null



  
  
      
    ) dbt_internal_test
[0m00:29:05.980413 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m00:29:05.982495 [debug] [Thread-1 (]: On test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d: ROLLBACK
[0m00:29:05.983447 [debug] [Thread-1 (]: On test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d: Close
[0m00:29:05.988526 [info ] [Thread-1 (]: 2 of 9 PASS not_null_geo_dim_geo_id ............................................ [[32mPASS[0m in 0.04s]
[0m00:29:05.990641 [debug] [Thread-1 (]: Finished running node test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m00:29:05.991809 [debug] [Thread-1 (]: Began running node test.student_dwh.not_null_product_dim_prod_id.a7c013c688
[0m00:29:05.993893 [info ] [Thread-1 (]: 3 of 9 START test not_null_product_dim_prod_id ................................. [RUN]
[0m00:29:05.996335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.student_dwh.not_null_product_dim_prod_id.a7c013c688)
[0m00:29:05.997283 [debug] [Thread-1 (]: Began compiling node test.student_dwh.not_null_product_dim_prod_id.a7c013c688
[0m00:29:06.004415 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m00:29:06.006155 [debug] [Thread-1 (]: Began executing node test.student_dwh.not_null_product_dim_prod_id.a7c013c688
[0m00:29:06.011912 [debug] [Thread-1 (]: Writing runtime sql for node "test.student_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m00:29:06.013117 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m00:29:06.013841 [debug] [Thread-1 (]: On test.student_dwh.not_null_product_dim_prod_id.a7c013c688: BEGIN
[0m00:29:06.014398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:06.023287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m00:29:06.024431 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m00:29:06.025921 [debug] [Thread-1 (]: On test.student_dwh.not_null_product_dim_prod_id.a7c013c688: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "test.student_dwh.not_null_product_dim_prod_id.a7c013c688"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select prod_id
from "superstore"."dw_student"."product_dim"
where prod_id is null



  
  
      
    ) dbt_internal_test
[0m00:29:06.055922 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.028 seconds
[0m00:29:06.058836 [debug] [Thread-1 (]: On test.student_dwh.not_null_product_dim_prod_id.a7c013c688: ROLLBACK
[0m00:29:06.060008 [debug] [Thread-1 (]: On test.student_dwh.not_null_product_dim_prod_id.a7c013c688: Close
[0m00:29:06.065523 [info ] [Thread-1 (]: 3 of 9 PASS not_null_product_dim_prod_id ....................................... [[32mPASS[0m in 0.07s]
[0m00:29:06.067620 [debug] [Thread-1 (]: Finished running node test.student_dwh.not_null_product_dim_prod_id.a7c013c688
[0m00:29:06.069051 [debug] [Thread-1 (]: Began running node test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m00:29:06.070599 [info ] [Thread-1 (]: 4 of 9 START test not_null_shipping_dim_ship_id ................................ [RUN]
[0m00:29:06.072183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.not_null_product_dim_prod_id.a7c013c688, now test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d)
[0m00:29:06.072981 [debug] [Thread-1 (]: Began compiling node test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m00:29:06.079094 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m00:29:06.080298 [debug] [Thread-1 (]: Began executing node test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m00:29:06.085369 [debug] [Thread-1 (]: Writing runtime sql for node "test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m00:29:06.087056 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m00:29:06.087985 [debug] [Thread-1 (]: On test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d: BEGIN
[0m00:29:06.088953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:06.101273 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m00:29:06.102630 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m00:29:06.103616 [debug] [Thread-1 (]: On test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from "superstore"."dw_student"."shipping_dim"
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m00:29:06.111751 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m00:29:06.114640 [debug] [Thread-1 (]: On test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d: ROLLBACK
[0m00:29:06.115772 [debug] [Thread-1 (]: On test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d: Close
[0m00:29:06.120097 [info ] [Thread-1 (]: 4 of 9 PASS not_null_shipping_dim_ship_id ...................................... [[32mPASS[0m in 0.05s]
[0m00:29:06.121769 [debug] [Thread-1 (]: Finished running node test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m00:29:06.122965 [debug] [Thread-1 (]: Began running node test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m00:29:06.124112 [info ] [Thread-1 (]: 5 of 9 START test relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ . [RUN]
[0m00:29:06.124831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m00:29:06.125260 [debug] [Thread-1 (]: Began compiling node test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m00:29:06.137963 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m00:29:06.139818 [debug] [Thread-1 (]: Began executing node test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m00:29:06.145397 [debug] [Thread-1 (]: Writing runtime sql for node "test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m00:29:06.146884 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m00:29:06.147727 [debug] [Thread-1 (]: On test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: BEGIN
[0m00:29:06.148450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:06.160880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m00:29:06.162327 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m00:29:06.163540 [debug] [Thread-1 (]: On test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select cust_id as from_field
    from "superstore"."dw_student"."sales_fact"
    where cust_id is not null
),

parent as (
    select cust_id as to_field
    from "superstore"."dw_student"."customer_dim"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:29:06.195776 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.031 seconds
[0m00:29:06.198084 [debug] [Thread-1 (]: On test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: ROLLBACK
[0m00:29:06.205051 [debug] [Thread-1 (]: On test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279: Close
[0m00:29:06.209315 [info ] [Thread-1 (]: 5 of 9 PASS relationships_sales_fact_cust_id__cust_id__ref_customer_dim_ ....... [[32mPASS[0m in 0.08s]
[0m00:29:06.211505 [debug] [Thread-1 (]: Finished running node test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m00:29:06.214334 [debug] [Thread-1 (]: Began running node test.student_dwh.unique_customer_dim_cust_id.4713a3a721
[0m00:29:06.215730 [info ] [Thread-1 (]: 6 of 9 START test unique_customer_dim_cust_id .................................. [RUN]
[0m00:29:06.218896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279, now test.student_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m00:29:06.219639 [debug] [Thread-1 (]: Began compiling node test.student_dwh.unique_customer_dim_cust_id.4713a3a721
[0m00:29:06.255535 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m00:29:06.261789 [debug] [Thread-1 (]: Began executing node test.student_dwh.unique_customer_dim_cust_id.4713a3a721
[0m00:29:06.274071 [debug] [Thread-1 (]: Writing runtime sql for node "test.student_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m00:29:06.275909 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m00:29:06.280594 [debug] [Thread-1 (]: On test.student_dwh.unique_customer_dim_cust_id.4713a3a721: BEGIN
[0m00:29:06.282855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:06.306417 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m00:29:06.307905 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m00:29:06.308777 [debug] [Thread-1 (]: On test.student_dwh.unique_customer_dim_cust_id.4713a3a721: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "test.student_dwh.unique_customer_dim_cust_id.4713a3a721"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cust_id as unique_field,
    count(*) as n_records

from "superstore"."dw_student"."customer_dim"
where cust_id is not null
group by cust_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:29:06.322014 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m00:29:06.328225 [debug] [Thread-1 (]: On test.student_dwh.unique_customer_dim_cust_id.4713a3a721: ROLLBACK
[0m00:29:06.331260 [debug] [Thread-1 (]: On test.student_dwh.unique_customer_dim_cust_id.4713a3a721: Close
[0m00:29:06.336098 [info ] [Thread-1 (]: 6 of 9 PASS unique_customer_dim_cust_id ........................................ [[32mPASS[0m in 0.12s]
[0m00:29:06.340015 [debug] [Thread-1 (]: Finished running node test.student_dwh.unique_customer_dim_cust_id.4713a3a721
[0m00:29:06.340805 [debug] [Thread-1 (]: Began running node test.student_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m00:29:06.341592 [info ] [Thread-1 (]: 7 of 9 START test unique_geo_dim_geo_id ........................................ [RUN]
[0m00:29:06.342754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.unique_customer_dim_cust_id.4713a3a721, now test.student_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m00:29:06.343544 [debug] [Thread-1 (]: Began compiling node test.student_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m00:29:06.350637 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m00:29:06.352914 [debug] [Thread-1 (]: Began executing node test.student_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m00:29:06.358406 [debug] [Thread-1 (]: Writing runtime sql for node "test.student_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m00:29:06.359671 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m00:29:06.362147 [debug] [Thread-1 (]: On test.student_dwh.unique_geo_dim_geo_id.1203f3ade2: BEGIN
[0m00:29:06.364798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:06.381314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m00:29:06.383114 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m00:29:06.387080 [debug] [Thread-1 (]: On test.student_dwh.unique_geo_dim_geo_id.1203f3ade2: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "test.student_dwh.unique_geo_dim_geo_id.1203f3ade2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geo_id as unique_field,
    count(*) as n_records

from "superstore"."dw_student"."geo_dim"
where geo_id is not null
group by geo_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:29:06.398502 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m00:29:06.404213 [debug] [Thread-1 (]: On test.student_dwh.unique_geo_dim_geo_id.1203f3ade2: ROLLBACK
[0m00:29:06.408699 [debug] [Thread-1 (]: On test.student_dwh.unique_geo_dim_geo_id.1203f3ade2: Close
[0m00:29:06.409989 [info ] [Thread-1 (]: 7 of 9 PASS unique_geo_dim_geo_id .............................................. [[32mPASS[0m in 0.07s]
[0m00:29:06.419074 [debug] [Thread-1 (]: Finished running node test.student_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m00:29:06.423380 [debug] [Thread-1 (]: Began running node test.student_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m00:29:06.428626 [info ] [Thread-1 (]: 8 of 9 START test unique_product_dim_prod_id ................................... [RUN]
[0m00:29:06.433255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.unique_geo_dim_geo_id.1203f3ade2, now test.student_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m00:29:06.436755 [debug] [Thread-1 (]: Began compiling node test.student_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m00:29:06.447076 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m00:29:06.448616 [debug] [Thread-1 (]: Began executing node test.student_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m00:29:06.453403 [debug] [Thread-1 (]: Writing runtime sql for node "test.student_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m00:29:06.454913 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m00:29:06.455889 [debug] [Thread-1 (]: On test.student_dwh.unique_product_dim_prod_id.c4c4789a7c: BEGIN
[0m00:29:06.456883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:06.475662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m00:29:06.476692 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m00:29:06.478101 [debug] [Thread-1 (]: On test.student_dwh.unique_product_dim_prod_id.c4c4789a7c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "test.student_dwh.unique_product_dim_prod_id.c4c4789a7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    prod_id as unique_field,
    count(*) as n_records

from "superstore"."dw_student"."product_dim"
where prod_id is not null
group by prod_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:29:06.507718 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.029 seconds
[0m00:29:06.510525 [debug] [Thread-1 (]: On test.student_dwh.unique_product_dim_prod_id.c4c4789a7c: ROLLBACK
[0m00:29:06.511947 [debug] [Thread-1 (]: On test.student_dwh.unique_product_dim_prod_id.c4c4789a7c: Close
[0m00:29:06.516865 [info ] [Thread-1 (]: 8 of 9 PASS unique_product_dim_prod_id ......................................... [[32mPASS[0m in 0.08s]
[0m00:29:06.518632 [debug] [Thread-1 (]: Finished running node test.student_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m00:29:06.520218 [debug] [Thread-1 (]: Began running node test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m00:29:06.521474 [info ] [Thread-1 (]: 9 of 9 START test unique_shipping_dim_ship_id .................................. [RUN]
[0m00:29:06.523939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.unique_product_dim_prod_id.c4c4789a7c, now test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m00:29:06.525121 [debug] [Thread-1 (]: Began compiling node test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m00:29:06.534180 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m00:29:06.535510 [debug] [Thread-1 (]: Began executing node test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m00:29:06.540538 [debug] [Thread-1 (]: Writing runtime sql for node "test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m00:29:06.541506 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m00:29:06.542074 [debug] [Thread-1 (]: On test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7: BEGIN
[0m00:29:06.542618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:06.556019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m00:29:06.557122 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m00:29:06.557988 [debug] [Thread-1 (]: On test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ship_id as unique_field,
    count(*) as n_records

from "superstore"."dw_student"."shipping_dim"
where ship_id is not null
group by ship_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:29:06.564597 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m00:29:06.568608 [debug] [Thread-1 (]: On test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7: ROLLBACK
[0m00:29:06.570035 [debug] [Thread-1 (]: On test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7: Close
[0m00:29:06.571543 [info ] [Thread-1 (]: 9 of 9 PASS unique_shipping_dim_ship_id ........................................ [[32mPASS[0m in 0.05s]
[0m00:29:06.575230 [debug] [Thread-1 (]: Finished running node test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m00:29:06.578675 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:06.581096 [debug] [MainThread]: On master: BEGIN
[0m00:29:06.584015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:29:06.598660 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m00:29:06.599934 [debug] [MainThread]: On master: COMMIT
[0m00:29:06.600961 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:06.601793 [debug] [MainThread]: On master: COMMIT
[0m00:29:06.603795 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:29:06.605645 [debug] [MainThread]: On master: Close
[0m00:29:06.608934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:06.609589 [debug] [MainThread]: Connection 'test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7' was properly closed.
[0m00:29:06.610188 [info ] [MainThread]: 
[0m00:29:06.611306 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m00:29:06.613638 [debug] [MainThread]: Command end result
[0m00:29:06.666576 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m00:29:06.671401 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m00:29:06.712964 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m00:29:06.713808 [info ] [MainThread]: 
[0m00:29:06.715160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:29:06.716204 [info ] [MainThread]: 
[0m00:29:06.724122 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m00:29:06.732511 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.1636322, "process_in_blocks": "0", "process_kernel_time": 0.268447, "process_mem_max_rss": "117388", "process_out_blocks": "2104", "process_user_time": 3.343488}
[0m00:29:06.737133 [debug] [MainThread]: Command `dbt test` succeeded at 00:29:06.736588 after 2.17 seconds
[0m00:29:06.739698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b35494a9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3546d73a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b35485b34f0>]}
[0m00:29:06.741635 [debug] [MainThread]: Flushing usage events
[0m00:29:07.336201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:46.849678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9c09cbd7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9c08c74bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9c08c74b50>]}


============================== 18:57:46.854616 | b2d1a01e-c630-4af0-b7c5-646aa7f344a8 ==============================
[0m18:57:46.854616 [info ] [MainThread]: Running with dbt=1.10.11
[0m18:57:46.855118 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'static_parser': 'True', 'warn_error': 'None', 'version_check': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'log_format': 'default', 'empty': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'profiles_dir': '/home/dev/.dbt', 'invocation_command': 'dbt debug', 'debug': 'False', 'target_path': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80'}
[0m18:57:46.879483 [info ] [MainThread]: dbt version: 1.10.11
[0m18:57:46.880002 [info ] [MainThread]: python version: 3.10.12
[0m18:57:46.880390 [info ] [MainThread]: python path: /home/dev/Downloads/pde_magistr/dbt-env/bin/python3
[0m18:57:46.880707 [info ] [MainThread]: os info: Linux-6.8.0-85-generic-x86_64-with-glibc2.35
[0m18:57:47.016022 [info ] [MainThread]: Using profiles dir at /home/dev/.dbt
[0m18:57:47.016888 [info ] [MainThread]: Using profiles.yml file at /home/dev/.dbt/profiles.yml
[0m18:57:47.017471 [info ] [MainThread]: Using dbt_project.yml file at /home/dev/Downloads/pde_magistr/student_dwh/dbt_project.yml
[0m18:57:47.019080 [info ] [MainThread]: adapter type: postgres
[0m18:57:47.019896 [info ] [MainThread]: adapter version: 1.9.1
[0m18:57:47.139573 [info ] [MainThread]: Configuration:
[0m18:57:47.140132 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:57:47.140953 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:57:47.141706 [info ] [MainThread]: Required dependencies:
[0m18:57:47.142176 [debug] [MainThread]: Executing "git --help"
[0m18:57:47.146132 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:57:47.146947 [debug] [MainThread]: STDERR: "b''"
[0m18:57:47.147582 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:57:47.148841 [info ] [MainThread]: Connection:
[0m18:57:47.149502 [info ] [MainThread]:   host: 192.168.31.248
[0m18:57:47.150157 [info ] [MainThread]:   port: 5432
[0m18:57:47.150943 [info ] [MainThread]:   user: admin
[0m18:57:47.151536 [info ] [MainThread]:   database: superstore
[0m18:57:47.152309 [info ] [MainThread]:   schema: dw_student
[0m18:57:47.152688 [info ] [MainThread]:   connect_timeout: 10
[0m18:57:47.153354 [info ] [MainThread]:   role: None
[0m18:57:47.153707 [info ] [MainThread]:   search_path: None
[0m18:57:47.154103 [info ] [MainThread]:   keepalives_idle: 0
[0m18:57:47.154531 [info ] [MainThread]:   sslmode: None
[0m18:57:47.154927 [info ] [MainThread]:   sslcert: None
[0m18:57:47.155344 [info ] [MainThread]:   sslkey: None
[0m18:57:47.155746 [info ] [MainThread]:   sslrootcert: None
[0m18:57:47.156130 [info ] [MainThread]:   application_name: dbt
[0m18:57:47.156534 [info ] [MainThread]:   retries: 1
[0m18:57:47.157132 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:57:47.274707 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:57:47.299883 [debug] [MainThread]: Using postgres connection "debug"
[0m18:57:47.300547 [debug] [MainThread]: On debug: select 1 as id
[0m18:57:47.301132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:47.325213 [debug] [MainThread]: SQL status: SELECT 1 in 0.024 seconds
[0m18:57:47.326639 [debug] [MainThread]: On debug: Close
[0m18:57:47.327260 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:57:47.327844 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:57:47.328869 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5522762, "process_in_blocks": "56944", "process_kernel_time": 0.181788, "process_mem_max_rss": "108004", "process_out_blocks": "24", "process_user_time": 1.460169}
[0m18:57:47.329657 [debug] [MainThread]: Command `dbt debug` succeeded at 18:57:47.329554 after 0.55 seconds
[0m18:57:47.330070 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:57:47.330510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9c09cbd7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9c08c18520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9c081172b0>]}
[0m18:57:47.330977 [debug] [MainThread]: Flushing usage events
[0m18:57:49.198719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:54.448882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e207ad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1f760220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1f7601c0>]}


============================== 20:27:54.452928 | 9a2802db-bf2a-4d54-8968-0cac30843b0f ==============================
[0m20:27:54.452928 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:27:54.453894 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/dev/.dbt', 'printer_width': '80', 'use_experimental_parser': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart_pareto_customer_analysis', 'debug': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'False', 'target_path': 'None', 'cache_selected_only': 'False'}
[0m20:27:54.643053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a2802db-bf2a-4d54-8968-0cac30843b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1f6246a0>]}
[0m20:27:54.698789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a2802db-bf2a-4d54-8968-0cac30843b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1f75c3a0>]}
[0m20:27:54.700293 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:27:54.782698 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:27:54.931300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:27:54.932000 [debug] [MainThread]: Partial parsing: added file: student_dwh://models/marts/mart_pareto_customer_analysis.sql
[0m20:27:55.189310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.student_dwh.example
[0m20:27:55.201973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a2802db-bf2a-4d54-8968-0cac30843b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1f732380>]}
[0m20:27:55.285916 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:27:55.288937 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:27:55.310743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a2802db-bf2a-4d54-8968-0cac30843b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1f63f370>]}
[0m20:27:55.311403 [info ] [MainThread]: Found 8 models, 9 data tests, 1 source, 435 macros
[0m20:27:55.311817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a2802db-bf2a-4d54-8968-0cac30843b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1f63cbe0>]}
[0m20:27:55.313035 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:27:55.313609 [debug] [MainThread]: Command end result
[0m20:27:55.331755 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:27:55.333900 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:27:55.337373 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m20:27:55.338361 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.94200844, "process_in_blocks": "41248", "process_kernel_time": 0.161286, "process_mem_max_rss": "110780", "process_out_blocks": "2776", "process_user_time": 1.856505}
[0m20:27:55.338917 [debug] [MainThread]: Command `dbt run` succeeded at 20:27:55.338827 after 0.94 seconds
[0m20:27:55.339389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e207ad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1df31870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1ffe6650>]}
[0m20:27:55.339824 [debug] [MainThread]: Flushing usage events
[0m20:27:55.973441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:32:48.477775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65794ad810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6578464d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6578464d00>]}


============================== 20:32:48.480309 | 967825e8-5606-4ffb-a49e-934e36ca8d00 ==============================
[0m20:32:48.480309 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:32:48.480842 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'no_print': 'None', 'empty': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'version_check': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'invocation_command': 'dbt run --select mart_pareto_customer_analysis', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/dev/.dbt', 'target_path': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'introspect': 'True', 'static_parser': 'True'}
[0m20:32:48.644010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '967825e8-5606-4ffb-a49e-934e36ca8d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a657af26020>]}
[0m20:32:48.702297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '967825e8-5606-4ffb-a49e-934e36ca8d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6578467d60>]}
[0m20:32:48.703254 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:32:48.774676 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:32:48.876667 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:32:48.877373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '967825e8-5606-4ffb-a49e-934e36ca8d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6578c57d30>]}
[0m20:32:49.901997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '967825e8-5606-4ffb-a49e-934e36ca8d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65757a0cd0>]}
[0m20:32:50.028516 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:32:50.030592 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:32:50.040533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '967825e8-5606-4ffb-a49e-934e36ca8d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6576519660>]}
[0m20:32:50.041149 [info ] [MainThread]: Found 8 models, 9 data tests, 1 source, 435 macros
[0m20:32:50.041628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967825e8-5606-4ffb-a49e-934e36ca8d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a657651ace0>]}
[0m20:32:50.042904 [info ] [MainThread]: 
[0m20:32:50.043315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:32:50.043633 [info ] [MainThread]: 
[0m20:32:50.044089 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:32:50.045102 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m20:32:50.085875 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m20:32:50.086621 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m20:32:50.087092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:50.094978 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m20:32:50.096687 [debug] [ThreadPool]: On list_superstore: Close
[0m20:32:50.107001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_stg)
[0m20:32:50.113299 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:32:50.113843 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m20:32:50.114205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:50.122052 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:32:50.125637 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:32:50.126150 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m20:32:50.133509 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m20:32:50.135034 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m20:32:50.135651 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m20:32:50.136378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore_stg, now list_superstore_dw_student)
[0m20:32:50.138918 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:32:50.139323 [debug] [ThreadPool]: On list_superstore_dw_student: BEGIN
[0m20:32:50.139635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:50.145498 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m20:32:50.145916 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:32:50.146282 [debug] [ThreadPool]: On list_superstore_dw_student: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_student"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_student'
  
[0m20:32:50.149156 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m20:32:50.150813 [debug] [ThreadPool]: On list_superstore_dw_student: ROLLBACK
[0m20:32:50.151582 [debug] [ThreadPool]: On list_superstore_dw_student: Close
[0m20:32:50.157967 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:50.158475 [debug] [MainThread]: On master: BEGIN
[0m20:32:50.158779 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:32:50.165670 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:32:50.166660 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:50.167159 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:32:50.172619 [debug] [MainThread]: SQL status: SELECT 13 in 0.005 seconds
[0m20:32:50.175914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967825e8-5606-4ffb-a49e-934e36ca8d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a657af65de0>]}
[0m20:32:50.176423 [debug] [MainThread]: On master: ROLLBACK
[0m20:32:50.176951 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:50.177305 [debug] [MainThread]: On master: BEGIN
[0m20:32:50.177811 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:32:50.178152 [debug] [MainThread]: On master: COMMIT
[0m20:32:50.178483 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:50.178795 [debug] [MainThread]: On master: COMMIT
[0m20:32:50.179147 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:32:50.179496 [debug] [MainThread]: On master: Close
[0m20:32:50.184761 [debug] [Thread-1 (]: Began running node model.student_dwh.mart_pareto_customer_analysis
[0m20:32:50.185536 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_student.mart_pareto_customer_analysis .......... [RUN]
[0m20:32:50.186150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_student, now model.student_dwh.mart_pareto_customer_analysis)
[0m20:32:50.186591 [debug] [Thread-1 (]: Began compiling node model.student_dwh.mart_pareto_customer_analysis
[0m20:32:50.194780 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.mart_pareto_customer_analysis"
[0m20:32:50.197065 [debug] [Thread-1 (]: Began executing node model.student_dwh.mart_pareto_customer_analysis
[0m20:32:50.245349 [debug] [Thread-1 (]: Writing runtime sql for node "model.student_dwh.mart_pareto_customer_analysis"
[0m20:32:50.250113 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:32:50.251741 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: BEGIN
[0m20:32:50.252371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:50.260591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:32:50.261334 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:32:50.261971 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.mart_pareto_customer_analysis"} */

  
    

  create  table "superstore"."dw_student"."mart_pareto_customer_analysis__dbt_tmp"
  
  
    as
  
  (
    --"Хвост продаж". Процент от общей выручки, который приносят 20% самых прибыльных клиентов (Анализ Парето)
SELECT 
    ROUND(
        (SELECT SUM(sales) 
         FROM "superstore"."dw_student"."sales_fact" 
         WHERE cust_id IN (
             SELECT cust_id 
             FROM (
                 SELECT 
                     cust_id,
                     SUM(profit) as total_profit
                 FROM "superstore"."dw_student"."sales_fact" 
                 GROUP BY cust_id
                 ORDER BY total_profit DESC
                 LIMIT (SELECT CEIL(COUNT(DISTINCT cust_id) * 0.2) FROM "superstore"."dw_student"."sales_fact")
             ) as top_customers
         )) * 100.0 / 
        (SELECT SUM(sales) FROM "superstore"."dw_student"."sales_fact"),
    2) as percent_sales_from_top_20_percent_customers;
  );
  
[0m20:32:50.262947 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30:     2) as percent_sales_from_top_20_percent_customers;
                                                              ^

[0m20:32:50.263395 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: ROLLBACK
[0m20:32:50.264085 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: Close
[0m20:32:50.275357 [debug] [Thread-1 (]: Database Error in model mart_pareto_customer_analysis (models/marts/mart_pareto_customer_analysis.sql)
  syntax error at or near ";"
  LINE 30:     2) as percent_sales_from_top_20_percent_customers;
                                                                ^
  compiled code at target/run/student_dwh/models/marts/mart_pareto_customer_analysis.sql
[0m20:32:50.277789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '967825e8-5606-4ffb-a49e-934e36ca8d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6579726e60>]}
[0m20:32:50.278529 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dw_student.mart_pareto_customer_analysis . [[31mERROR[0m in 0.09s]
[0m20:32:50.279130 [debug] [Thread-1 (]: Finished running node model.student_dwh.mart_pareto_customer_analysis
[0m20:32:50.279672 [debug] [Thread-4 (]: Marking all children of 'model.student_dwh.mart_pareto_customer_analysis' to be skipped because of status 'error'.  Reason: Database Error in model mart_pareto_customer_analysis (models/marts/mart_pareto_customer_analysis.sql)
  syntax error at or near ";"
  LINE 30:     2) as percent_sales_from_top_20_percent_customers;
                                                                ^
  compiled code at target/run/student_dwh/models/marts/mart_pareto_customer_analysis.sql.
[0m20:32:50.281137 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:50.281566 [debug] [MainThread]: On master: BEGIN
[0m20:32:50.281885 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:32:50.291915 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:32:50.292519 [debug] [MainThread]: On master: COMMIT
[0m20:32:50.292860 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:50.293145 [debug] [MainThread]: On master: COMMIT
[0m20:32:50.293750 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:32:50.294126 [debug] [MainThread]: On master: Close
[0m20:32:50.294702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:50.295000 [debug] [MainThread]: Connection 'model.student_dwh.mart_pareto_customer_analysis' was properly closed.
[0m20:32:50.295382 [info ] [MainThread]: 
[0m20:32:50.296356 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m20:32:50.297793 [debug] [MainThread]: Command end result
[0m20:32:50.325596 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:32:50.327794 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:32:50.335952 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m20:32:50.336799 [info ] [MainThread]: 
[0m20:32:50.337616 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:32:50.338250 [info ] [MainThread]: 
[0m20:32:50.338817 [error] [MainThread]: [31mFailure in model mart_pareto_customer_analysis (models/marts/mart_pareto_customer_analysis.sql)[0m
[0m20:32:50.339514 [error] [MainThread]:   Database Error in model mart_pareto_customer_analysis (models/marts/mart_pareto_customer_analysis.sql)
  syntax error at or near ";"
  LINE 30:     2) as percent_sales_from_top_20_percent_customers;
                                                                ^
  compiled code at target/run/student_dwh/models/marts/mart_pareto_customer_analysis.sql
[0m20:32:50.340494 [info ] [MainThread]: 
[0m20:32:50.341120 [info ] [MainThread]:   compiled code at target/compiled/student_dwh/models/marts/mart_pareto_customer_analysis.sql
[0m20:32:50.341864 [info ] [MainThread]: 
[0m20:32:50.342394 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:32:50.343612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9151019, "process_in_blocks": "4880", "process_kernel_time": 0.177526, "process_mem_max_rss": "123804", "process_out_blocks": "2856", "process_user_time": 2.695548}
[0m20:32:50.344173 [debug] [MainThread]: Command `dbt run` failed at 20:32:50.344081 after 1.92 seconds
[0m20:32:50.344600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65794ad810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a657aa89fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6579391750>]}
[0m20:32:50.345008 [debug] [MainThread]: Flushing usage events
[0m20:32:51.101194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:45.514386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2afcbd7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2aec78d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2aec78cd0>]}


============================== 20:33:45.516963 | 0b9c1565-dbf4-4870-8658-e82ca18f9340 ==============================
[0m20:33:45.516963 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:33:45.517592 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True', 'profiles_dir': '/home/dev/.dbt', 'use_experimental_parser': 'False', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select mart_pareto_customer_analysis', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'static_parser': 'True', 'version_check': 'True', 'empty': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:33:45.694845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b9c1565-dbf4-4870-8658-e82ca18f9340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2b172d3f0>]}
[0m20:33:45.747436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b9c1565-dbf4-4870-8658-e82ca18f9340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2aec7bd30>]}
[0m20:33:45.748597 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:33:45.825051 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:33:45.938874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:33:45.939824 [debug] [MainThread]: Partial parsing: updated file: student_dwh://models/marts/mart_pareto_customer_analysis.sql
[0m20:33:46.212979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b9c1565-dbf4-4870-8658-e82ca18f9340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2ae531870>]}
[0m20:33:46.297641 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:33:46.299793 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:33:46.310347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b9c1565-dbf4-4870-8658-e82ca18f9340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2ad597820>]}
[0m20:33:46.311067 [info ] [MainThread]: Found 8 models, 9 data tests, 1 source, 435 macros
[0m20:33:46.311593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b9c1565-dbf4-4870-8658-e82ca18f9340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2ad5955a0>]}
[0m20:33:46.313044 [info ] [MainThread]: 
[0m20:33:46.313523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:33:46.313901 [info ] [MainThread]: 
[0m20:33:46.314536 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:33:46.315614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m20:33:46.347969 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m20:33:46.350723 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m20:33:46.351258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:46.362259 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m20:33:46.363897 [debug] [ThreadPool]: On list_superstore: Close
[0m20:33:46.369557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_stg)
[0m20:33:46.375938 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:33:46.376502 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m20:33:46.376823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:46.384223 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:33:46.384888 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:33:46.385313 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m20:33:46.387930 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m20:33:46.389703 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m20:33:46.390406 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m20:33:46.391115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore_stg, now list_superstore_dw_student)
[0m20:33:46.393096 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:33:46.393430 [debug] [ThreadPool]: On list_superstore_dw_student: BEGIN
[0m20:33:46.393758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:46.402611 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:33:46.403188 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:33:46.403653 [debug] [ThreadPool]: On list_superstore_dw_student: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_student"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_student'
  
[0m20:33:46.407850 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:33:46.409541 [debug] [ThreadPool]: On list_superstore_dw_student: ROLLBACK
[0m20:33:46.410258 [debug] [ThreadPool]: On list_superstore_dw_student: Close
[0m20:33:46.416113 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:46.416536 [debug] [MainThread]: On master: BEGIN
[0m20:33:46.416816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:46.425036 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:33:46.425665 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:46.426456 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:33:46.430310 [debug] [MainThread]: SQL status: SELECT 13 in 0.003 seconds
[0m20:33:46.433949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b9c1565-dbf4-4870-8658-e82ca18f9340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2b17694e0>]}
[0m20:33:46.434571 [debug] [MainThread]: On master: ROLLBACK
[0m20:33:46.435385 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:46.435779 [debug] [MainThread]: On master: BEGIN
[0m20:33:46.436765 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:33:46.437146 [debug] [MainThread]: On master: COMMIT
[0m20:33:46.437579 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:46.437885 [debug] [MainThread]: On master: COMMIT
[0m20:33:46.438571 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:33:46.439009 [debug] [MainThread]: On master: Close
[0m20:33:46.441857 [debug] [Thread-1 (]: Began running node model.student_dwh.mart_pareto_customer_analysis
[0m20:33:46.442539 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_student.mart_pareto_customer_analysis .......... [RUN]
[0m20:33:46.443071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_student, now model.student_dwh.mart_pareto_customer_analysis)
[0m20:33:46.443536 [debug] [Thread-1 (]: Began compiling node model.student_dwh.mart_pareto_customer_analysis
[0m20:33:46.461566 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.mart_pareto_customer_analysis"
[0m20:33:46.462603 [debug] [Thread-1 (]: Began executing node model.student_dwh.mart_pareto_customer_analysis
[0m20:33:46.504857 [debug] [Thread-1 (]: Writing runtime sql for node "model.student_dwh.mart_pareto_customer_analysis"
[0m20:33:46.505999 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:33:46.506712 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: BEGIN
[0m20:33:46.507157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:46.518924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m20:33:46.520836 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:33:46.521607 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.mart_pareto_customer_analysis"} */

  
    

  create  table "superstore"."dw_student"."mart_pareto_customer_analysis__dbt_tmp"
  
  
    as
  
  (
    --"Хвост продаж". Процент от общей выручки, который приносят 20% самых прибыльных клиентов (Анализ Парето)
SELECT 
    ROUND(
        (SELECT SUM(sales) 
         FROM "superstore"."dw_student"."sales_fact" 
         WHERE cust_id IN (
             SELECT cust_id 
             FROM (
                 SELECT 
                     cust_id,
                     SUM(profit) as total_profit
                 FROM "superstore"."dw_student"."sales_fact" 
                 GROUP BY cust_id
                 ORDER BY total_profit DESC
                 LIMIT (SELECT CEIL(COUNT(DISTINCT cust_id) * 0.2) FROM "superstore"."dw_student"."sales_fact")
             ) as top_customers
         )) * 100.0 / 
        (SELECT SUM(sales) FROM "superstore"."dw_student"."sales_fact"),
    2) as percent_sales_from_top_20_percent_customers
  );
  
[0m20:33:46.691907 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.170 seconds
[0m20:33:46.700698 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:33:46.701389 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.mart_pareto_customer_analysis"} */
alter table "superstore"."dw_student"."mart_pareto_customer_analysis__dbt_tmp" rename to "mart_pareto_customer_analysis"
[0m20:33:46.702327 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:33:46.713465 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: COMMIT
[0m20:33:46.714145 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:33:46.714576 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: COMMIT
[0m20:33:46.717647 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:33:46.723137 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_student"."mart_pareto_customer_analysis__dbt_backup"
[0m20:33:46.727123 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:33:46.727644 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.mart_pareto_customer_analysis"} */
drop table if exists "superstore"."dw_student"."mart_pareto_customer_analysis__dbt_backup" cascade
[0m20:33:46.728498 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m20:33:46.730934 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: Close
[0m20:33:46.734775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b9c1565-dbf4-4870-8658-e82ca18f9340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2ab6b6740>]}
[0m20:33:46.735500 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw_student.mart_pareto_customer_analysis ..... [[32mSELECT 1[0m in 0.29s]
[0m20:33:46.736148 [debug] [Thread-1 (]: Finished running node model.student_dwh.mart_pareto_customer_analysis
[0m20:33:46.737447 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:46.737878 [debug] [MainThread]: On master: BEGIN
[0m20:33:46.738382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:46.746131 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:33:46.746850 [debug] [MainThread]: On master: COMMIT
[0m20:33:46.747220 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:46.747868 [debug] [MainThread]: On master: COMMIT
[0m20:33:46.748442 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:33:46.749645 [debug] [MainThread]: On master: Close
[0m20:33:46.750300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:46.750642 [debug] [MainThread]: Connection 'model.student_dwh.mart_pareto_customer_analysis' was properly closed.
[0m20:33:46.750952 [info ] [MainThread]: 
[0m20:33:46.753293 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m20:33:46.753929 [debug] [MainThread]: Command end result
[0m20:33:46.776171 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:33:46.778225 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:33:46.784266 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m20:33:46.784704 [info ] [MainThread]: 
[0m20:33:46.785126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:46.785569 [info ] [MainThread]: 
[0m20:33:46.785922 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:33:46.787026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3246932, "process_in_blocks": "64", "process_kernel_time": 0.154061, "process_mem_max_rss": "120000", "process_out_blocks": "2848", "process_user_time": 2.004834}
[0m20:33:46.788147 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:46.787954 after 1.33 seconds
[0m20:33:46.788701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2afcbd7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2aec45ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b2aec71630>]}
[0m20:33:46.789262 [debug] [MainThread]: Flushing usage events
[0m20:33:47.451400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:36:46.235654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bffaefad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bffadf64220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bffadf641c0>]}


============================== 20:36:46.238654 | c351f253-fff2-41b0-a802-fbe73679e21b ==============================
[0m20:36:46.238654 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:36:46.239301 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'profiles_dir': '/home/dev/.dbt', 'no_print': 'None', 'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select mart_pareto_customer_analysis', 'log_format': 'default', 'version_check': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'partial_parse': 'True', 'use_colors': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'indirect_selection': 'eager'}
[0m20:36:46.525076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c351f253-fff2-41b0-a802-fbe73679e21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bffade26260>]}
[0m20:36:46.579134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c351f253-fff2-41b0-a802-fbe73679e21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bffae0f5120>]}
[0m20:36:46.580094 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:36:46.665419 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:36:46.780784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:46.781299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:46.824181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c351f253-fff2-41b0-a802-fbe73679e21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bffacbbd4e0>]}
[0m20:36:46.901743 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:36:46.903739 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:36:46.970823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c351f253-fff2-41b0-a802-fbe73679e21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bffadf64940>]}
[0m20:36:46.971525 [info ] [MainThread]: Found 8 models, 9 data tests, 1 source, 435 macros
[0m20:36:46.971989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c351f253-fff2-41b0-a802-fbe73679e21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bffadf64970>]}
[0m20:36:46.973272 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:36:46.975087 [debug] [MainThread]: Command end result
[0m20:36:46.994415 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:36:46.996400 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:36:46.999901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m20:36:47.000861 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.821154, "process_in_blocks": "1432", "process_kernel_time": 0.136611, "process_mem_max_rss": "108088", "process_out_blocks": "1904", "process_user_time": 1.567014}
[0m20:36:47.001364 [debug] [MainThread]: Command `dbt test` succeeded at 20:36:47.001247 after 0.82 seconds
[0m20:36:47.001800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bffaefad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bffade26260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bffacb7cfd0>]}
[0m20:36:47.002247 [debug] [MainThread]: Flushing usage events
[0m20:36:47.720778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:37:29.884371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c6ca5840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c5c5c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c5c5c190>]}


============================== 20:37:29.886976 | 08df236d-35f3-47df-bbcb-22a8c534fcb8 ==============================
[0m20:37:29.886976 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:37:29.887544 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt test --select mart_pareto_customer_analysis', 'log_format': 'default', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/dev/.dbt', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'quiet': 'False', 'use_colors': 'True'}
[0m20:37:30.020428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08df236d-35f3-47df-bbcb-22a8c534fcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c5c00130>]}
[0m20:37:30.072087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08df236d-35f3-47df-bbcb-22a8c534fcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c5dec850>]}
[0m20:37:30.073040 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:37:30.145345 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:37:30.252163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:37:30.252683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:37:30.294349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08df236d-35f3-47df-bbcb-22a8c534fcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c45b1540>]}
[0m20:37:30.371961 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:37:30.373857 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:37:30.438771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08df236d-35f3-47df-bbcb-22a8c534fcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c5b3aef0>]}
[0m20:37:30.439425 [info ] [MainThread]: Found 8 models, 9 data tests, 1 source, 435 macros
[0m20:37:30.439838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08df236d-35f3-47df-bbcb-22a8c534fcb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c5b39540>]}
[0m20:37:30.441047 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:37:30.442814 [debug] [MainThread]: Command end result
[0m20:37:30.461026 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:37:30.462982 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:37:30.466116 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m20:37:30.467009 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.62810725, "process_in_blocks": "0", "process_kernel_time": 0.107971, "process_mem_max_rss": "108208", "process_out_blocks": "1904", "process_user_time": 1.503602}
[0m20:37:30.467546 [debug] [MainThread]: Command `dbt test` succeeded at 20:37:30.467455 after 0.63 seconds
[0m20:37:30.468001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c6ca5840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c6481300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c6482ef0>]}
[0m20:37:30.468452 [debug] [MainThread]: Flushing usage events
[0m20:37:31.066390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:54.562254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8f7bb5870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8f6b6cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8f6b6cd60>]}


============================== 20:38:54.565081 | f6478412-db5a-42d2-bc1d-9cbef52774cd ==============================
[0m20:38:54.565081 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:38:54.565720 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'version_check': 'True', 'introspect': 'True', 'profiles_dir': '/home/dev/.dbt', 'printer_width': '80', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select mart_pareto_customer_analysi', 'partial_parse': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'static_parser': 'True', 'debug': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'log_format': 'default', 'fail_fast': 'False'}
[0m20:38:54.700842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6478412-db5a-42d2-bc1d-9cbef52774cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8f6b6d9c0>]}
[0m20:38:54.753220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6478412-db5a-42d2-bc1d-9cbef52774cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8f6b38e50>]}
[0m20:38:54.754142 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:38:54.835448 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:38:54.954268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:38:54.954839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:38:55.008826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6478412-db5a-42d2-bc1d-9cbef52774cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8f55c1450>]}
[0m20:38:55.088399 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:38:55.090341 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:38:55.101215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6478412-db5a-42d2-bc1d-9cbef52774cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8f55c44c0>]}
[0m20:38:55.101894 [info ] [MainThread]: Found 8 models, 9 data tests, 1 source, 435 macros
[0m20:38:55.102281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6478412-db5a-42d2-bc1d-9cbef52774cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8f55c4610>]}
[0m20:38:55.102916 [warn ] [MainThread]: The selection criterion 'mart_pareto_customer_analysi' does not match any enabled nodes
[0m20:38:55.103867 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:38:55.105756 [debug] [MainThread]: Command end result
[0m20:38:55.194078 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:38:55.196801 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:38:55.200260 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m20:38:55.201167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6845893, "process_in_blocks": "0", "process_kernel_time": 0.127464, "process_mem_max_rss": "107568", "process_out_blocks": "1904", "process_user_time": 1.581997}
[0m20:38:55.201689 [debug] [MainThread]: Command `dbt run` succeeded at 20:38:55.201601 after 0.69 seconds
[0m20:38:55.202091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8f7bb5870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8f6d86560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db8f6d85840>]}
[0m20:38:55.202479 [debug] [MainThread]: Flushing usage events
[0m20:38:55.902177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:58.655239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74920e9b5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74920d970d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74920d970d00>]}


============================== 20:39:58.657675 | fec9fe2b-65a1-4a3c-9c6a-9884999cb654 ==============================
[0m20:39:58.657675 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:39:58.658316 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'no_print': 'None', 'profiles_dir': '/home/dev/.dbt', 'printer_width': '80', 'partial_parse': 'True', 'empty': 'False', 'log_format': 'default', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'quiet': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --select mart_pareto_customer_analysis'}
[0m20:39:58.803733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fec9fe2b-65a1-4a3c-9c6a-9884999cb654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749210422020>]}
[0m20:39:58.854209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fec9fe2b-65a1-4a3c-9c6a-9884999cb654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74920d973d60>]}
[0m20:39:58.855266 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:39:58.935064 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:39:59.061525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:39:59.062037 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:39:59.104831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fec9fe2b-65a1-4a3c-9c6a-9884999cb654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74920c1c7fa0>]}
[0m20:39:59.183460 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:39:59.185418 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:39:59.195756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fec9fe2b-65a1-4a3c-9c6a-9884999cb654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74920c1c80d0>]}
[0m20:39:59.196369 [info ] [MainThread]: Found 8 models, 9 data tests, 1 source, 435 macros
[0m20:39:59.196837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fec9fe2b-65a1-4a3c-9c6a-9884999cb654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74920c1ca7d0>]}
[0m20:39:59.198125 [info ] [MainThread]: 
[0m20:39:59.198571 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:39:59.198908 [info ] [MainThread]: 
[0m20:39:59.199437 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:39:59.200435 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore'
[0m20:39:59.298693 [debug] [ThreadPool]: Using postgres connection "list_superstore"
[0m20:39:59.299356 [debug] [ThreadPool]: On list_superstore: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore"} */

    select distinct nspname from pg_namespace
  
[0m20:39:59.299727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:59.319031 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.019 seconds
[0m20:39:59.320552 [debug] [ThreadPool]: On list_superstore: Close
[0m20:39:59.324957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore, now list_superstore_dw_student)
[0m20:39:59.331797 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:39:59.332390 [debug] [ThreadPool]: On list_superstore_dw_student: BEGIN
[0m20:39:59.332720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:59.339626 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:39:59.340124 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:39:59.340538 [debug] [ThreadPool]: On list_superstore_dw_student: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_student"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_student'
  
[0m20:39:59.342941 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:39:59.344216 [debug] [ThreadPool]: On list_superstore_dw_student: ROLLBACK
[0m20:39:59.344776 [debug] [ThreadPool]: On list_superstore_dw_student: Close
[0m20:39:59.345467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore_dw_student, now list_superstore_stg)
[0m20:39:59.347512 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:39:59.349610 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m20:39:59.349997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:59.356543 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m20:39:59.356999 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:39:59.357419 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m20:39:59.359756 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m20:39:59.360947 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m20:39:59.361482 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m20:39:59.366046 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:59.366504 [debug] [MainThread]: On master: BEGIN
[0m20:39:59.366800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:59.373355 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m20:39:59.373852 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:59.374278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:39:59.377175 [debug] [MainThread]: SQL status: SELECT 13 in 0.003 seconds
[0m20:39:59.381175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fec9fe2b-65a1-4a3c-9c6a-9884999cb654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74920c1c85b0>]}
[0m20:39:59.381726 [debug] [MainThread]: On master: ROLLBACK
[0m20:39:59.382321 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:59.382673 [debug] [MainThread]: On master: BEGIN
[0m20:39:59.383170 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:39:59.383533 [debug] [MainThread]: On master: COMMIT
[0m20:39:59.383829 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:59.384108 [debug] [MainThread]: On master: COMMIT
[0m20:39:59.384505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:39:59.384816 [debug] [MainThread]: On master: Close
[0m20:39:59.386811 [debug] [Thread-1 (]: Began running node model.student_dwh.mart_pareto_customer_analysis
[0m20:39:59.387495 [info ] [Thread-1 (]: 1 of 1 START sql table model dw_student.mart_pareto_customer_analysis .......... [RUN]
[0m20:39:59.388070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now model.student_dwh.mart_pareto_customer_analysis)
[0m20:39:59.389524 [debug] [Thread-1 (]: Began compiling node model.student_dwh.mart_pareto_customer_analysis
[0m20:39:59.399398 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.mart_pareto_customer_analysis"
[0m20:39:59.400278 [debug] [Thread-1 (]: Began executing node model.student_dwh.mart_pareto_customer_analysis
[0m20:39:59.437247 [debug] [Thread-1 (]: Writing runtime sql for node "model.student_dwh.mart_pareto_customer_analysis"
[0m20:39:59.438481 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:39:59.438984 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: BEGIN
[0m20:39:59.439435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:59.446888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:39:59.447555 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:39:59.448135 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.mart_pareto_customer_analysis"} */

  
    

  create  table "superstore"."dw_student"."mart_pareto_customer_analysis__dbt_tmp"
  
  
    as
  
  (
    --"Хвост продаж". Процент от общей выручки, который приносят 20% самых прибыльных клиентов (Анализ Парето)
SELECT 
    ROUND(
        (SELECT SUM(sales) 
         FROM "superstore"."dw_student"."sales_fact" 
         WHERE cust_id IN (
             SELECT cust_id 
             FROM (
                 SELECT 
                     cust_id,
                     SUM(profit) as total_profit
                 FROM "superstore"."dw_student"."sales_fact" 
                 GROUP BY cust_id
                 ORDER BY total_profit DESC
                 LIMIT (SELECT CEIL(COUNT(DISTINCT cust_id) * 0.2) FROM "superstore"."dw_student"."sales_fact")
             ) as top_customers
         )) * 100.0 / 
        (SELECT SUM(sales) FROM "superstore"."dw_student"."sales_fact"),
    2) as percent_sales_from_top_20_percent_customers
  );
  
[0m20:39:59.602302 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.153 seconds
[0m20:39:59.611165 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:39:59.611992 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.mart_pareto_customer_analysis"} */
alter table "superstore"."dw_student"."mart_pareto_customer_analysis" rename to "mart_pareto_customer_analysis__dbt_backup"
[0m20:39:59.613017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:59.615970 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:39:59.616445 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.mart_pareto_customer_analysis"} */
alter table "superstore"."dw_student"."mart_pareto_customer_analysis__dbt_tmp" rename to "mart_pareto_customer_analysis"
[0m20:39:59.617369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:59.629597 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: COMMIT
[0m20:39:59.630295 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:39:59.630668 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: COMMIT
[0m20:39:59.632637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:39:59.638782 [debug] [Thread-1 (]: Applying DROP to: "superstore"."dw_student"."mart_pareto_customer_analysis__dbt_backup"
[0m20:39:59.642259 [debug] [Thread-1 (]: Using postgres connection "model.student_dwh.mart_pareto_customer_analysis"
[0m20:39:59.642792 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "model.student_dwh.mart_pareto_customer_analysis"} */
drop table if exists "superstore"."dw_student"."mart_pareto_customer_analysis__dbt_backup" cascade
[0m20:39:59.646730 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:39:59.649279 [debug] [Thread-1 (]: On model.student_dwh.mart_pareto_customer_analysis: Close
[0m20:39:59.650909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fec9fe2b-65a1-4a3c-9c6a-9884999cb654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749210198b80>]}
[0m20:39:59.651624 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dw_student.mart_pareto_customer_analysis ..... [[32mSELECT 1[0m in 0.26s]
[0m20:39:59.652281 [debug] [Thread-1 (]: Finished running node model.student_dwh.mart_pareto_customer_analysis
[0m20:39:59.653453 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:59.653922 [debug] [MainThread]: On master: BEGIN
[0m20:39:59.654262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:39:59.661634 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:39:59.662361 [debug] [MainThread]: On master: COMMIT
[0m20:39:59.662781 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:59.663084 [debug] [MainThread]: On master: COMMIT
[0m20:39:59.663641 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:39:59.664015 [debug] [MainThread]: On master: Close
[0m20:39:59.664530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:59.664819 [debug] [MainThread]: Connection 'model.student_dwh.mart_pareto_customer_analysis' was properly closed.
[0m20:39:59.665175 [info ] [MainThread]: 
[0m20:39:59.667656 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m20:39:59.668764 [debug] [MainThread]: Command end result
[0m20:39:59.691384 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:39:59.693633 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:39:59.701482 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m20:39:59.701947 [info ] [MainThread]: 
[0m20:39:59.702759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:59.703292 [info ] [MainThread]: 
[0m20:39:59.704059 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:39:59.705113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0959865, "process_in_blocks": "0", "process_kernel_time": 0.147226, "process_mem_max_rss": "116520", "process_out_blocks": "1952", "process_user_time": 1.845994}
[0m20:39:59.705646 [debug] [MainThread]: Command `dbt run` succeeded at 20:39:59.705546 after 1.10 seconds
[0m20:39:59.706017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74920e9b5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749210422020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74920c17fa60>]}
[0m20:39:59.706495 [debug] [MainThread]: Flushing usage events
[0m20:40:00.296544 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:27.498044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720918dbd810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720917d7cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720917d7ce80>]}


============================== 20:40:27.500786 | 0d910049-e34a-430c-bc7d-de653f9951cb ==============================
[0m20:40:27.500786 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:40:27.501392 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'empty': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'static_parser': 'True', 'version_check': 'True', 'log_format': 'default', 'partial_parse': 'True', 'printer_width': '80', 'debug': 'False', 'target_path': 'None', 'quiet': 'False', 'warn_error': 'None', 'invocation_command': 'dbt test --select mart_pareto_customer_analysis', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/dev/.dbt', 'indirect_selection': 'eager'}
[0m20:40:27.638637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d910049-e34a-430c-bc7d-de653f9951cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720917d1eef0>]}
[0m20:40:27.689385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d910049-e34a-430c-bc7d-de653f9951cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720917d74fd0>]}
[0m20:40:27.690527 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:40:27.762529 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:40:27.872142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:40:27.872745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:40:27.915923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d910049-e34a-430c-bc7d-de653f9951cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7209165cd510>]}
[0m20:40:27.996728 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:40:27.998751 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:40:28.073063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d910049-e34a-430c-bc7d-de653f9951cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7209185f62f0>]}
[0m20:40:28.073788 [info ] [MainThread]: Found 8 models, 9 data tests, 1 source, 435 macros
[0m20:40:28.074324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d910049-e34a-430c-bc7d-de653f9951cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7209185ccee0>]}
[0m20:40:28.075618 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:40:28.077565 [debug] [MainThread]: Command end result
[0m20:40:28.102043 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:40:28.104330 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:40:28.108687 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m20:40:28.109869 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.66008806, "process_in_blocks": "0", "process_kernel_time": 0.134948, "process_mem_max_rss": "108216", "process_out_blocks": "1896", "process_user_time": 1.512628}
[0m20:40:28.110511 [debug] [MainThread]: Command `dbt test` succeeded at 20:40:28.110403 after 0.66 seconds
[0m20:40:28.110990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720918dbd810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720917d74fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72091859aef0>]}
[0m20:40:28.111487 [debug] [MainThread]: Flushing usage events
[0m20:40:28.807974 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:39.174692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b8ea5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b7e5c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b7e5c190>]}


============================== 20:41:39.177314 | e6e70c95-8d1d-417c-8775-4ba1d5cbf491 ==============================
[0m20:41:39.177314 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:41:39.177974 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_format': 'default', 'introspect': 'True', 'partial_parse': 'True', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'empty': 'None', 'log_cache_events': 'False', 'profiles_dir': '/home/dev/.dbt', 'printer_width': '80', 'use_colors': 'True', 'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt test --select mart_pareto_customer_analysis', 'cache_selected_only': 'False'}
[0m20:41:39.311476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6e70c95-8d1d-417c-8775-4ba1d5cbf491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b7e03a90>]}
[0m20:41:39.361157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6e70c95-8d1d-417c-8775-4ba1d5cbf491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b7d1e590>]}
[0m20:41:39.362063 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:41:39.434363 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:41:39.543549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:41:39.544335 [debug] [MainThread]: Partial parsing: updated file: student_dwh://models/marts/schema.yml
[0m20:41:39.722292 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m20:41:39.722911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e6e70c95-8d1d-417c-8775-4ba1d5cbf491', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b86818d0>]}
[0m20:41:39.817435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6e70c95-8d1d-417c-8775-4ba1d5cbf491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b6380e50>]}
[0m20:41:39.892855 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:41:39.894908 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:41:39.911735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6e70c95-8d1d-417c-8775-4ba1d5cbf491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b5f43760>]}
[0m20:41:39.912348 [info ] [MainThread]: Found 8 models, 11 data tests, 1 source, 435 macros
[0m20:41:39.912702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e70c95-8d1d-417c-8775-4ba1d5cbf491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b5f414e0>]}
[0m20:41:39.914037 [info ] [MainThread]: 
[0m20:41:39.914436 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:41:39.914775 [info ] [MainThread]: 
[0m20:41:39.915247 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:41:39.919674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m20:41:39.950068 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:41:39.951318 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m20:41:39.951737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:39.962184 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:41:39.962825 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:41:39.963273 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m20:41:39.965628 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m20:41:39.966834 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m20:41:39.967472 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m20:41:39.968135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore_stg, now list_superstore_dw_student)
[0m20:41:39.973028 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:41:39.974347 [debug] [ThreadPool]: On list_superstore_dw_student: BEGIN
[0m20:41:39.974803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:39.982076 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:41:39.982751 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:41:39.983151 [debug] [ThreadPool]: On list_superstore_dw_student: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_student"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_student'
  
[0m20:41:39.985617 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:41:39.986930 [debug] [ThreadPool]: On list_superstore_dw_student: ROLLBACK
[0m20:41:39.987859 [debug] [ThreadPool]: On list_superstore_dw_student: Close
[0m20:41:39.994978 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:39.995518 [debug] [MainThread]: On master: BEGIN
[0m20:41:39.995836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:40.002665 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:41:40.003124 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:40.003565 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:41:40.006468 [debug] [MainThread]: SQL status: SELECT 13 in 0.002 seconds
[0m20:41:40.009803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e70c95-8d1d-417c-8775-4ba1d5cbf491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b9181840>]}
[0m20:41:40.010414 [debug] [MainThread]: On master: ROLLBACK
[0m20:41:40.011205 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:40.011566 [debug] [MainThread]: On master: BEGIN
[0m20:41:40.012491 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:41:40.012840 [debug] [MainThread]: On master: COMMIT
[0m20:41:40.013232 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:40.013580 [debug] [MainThread]: On master: COMMIT
[0m20:41:40.014016 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:41:40.014477 [debug] [MainThread]: On master: Close
[0m20:41:40.017450 [debug] [Thread-1 (]: Began running node test.student_dwh.dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0.4065b1919f
[0m20:41:40.018269 [info ] [Thread-1 (]: 1 of 2 START test dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0  [RUN]
[0m20:41:40.019007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_student, now test.student_dwh.dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0.4065b1919f)
[0m20:41:40.019465 [debug] [Thread-1 (]: Began compiling node test.student_dwh.dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0.4065b1919f
[0m20:41:40.044105 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0 (models/marts/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:41:40.045059 [error] [Thread-1 (]: 1 of 2 ERROR dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0  [[31mERROR[0m in 0.03s]
[0m20:41:40.045750 [debug] [Thread-1 (]: Finished running node test.student_dwh.dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0.4065b1919f
[0m20:41:40.046187 [debug] [Thread-1 (]: Began running node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:41:40.046896 [debug] [Thread-4 (]: Marking all children of 'test.student_dwh.dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0.4065b1919f' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0 (models/marts/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:41:40.046575 [info ] [Thread-1 (]: 2 of 2 START test not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers  [RUN]
[0m20:41:40.048412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0.4065b1919f, now test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327)
[0m20:41:40.048831 [debug] [Thread-1 (]: Began compiling node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:41:40.068997 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:41:40.072026 [debug] [Thread-1 (]: Began executing node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:41:40.096627 [debug] [Thread-1 (]: Writing runtime sql for node "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:41:40.099576 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:41:40.100176 [debug] [Thread-1 (]: On test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327: BEGIN
[0m20:41:40.101118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:40.110345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:41:40.111603 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:41:40.112085 [debug] [Thread-1 (]: On test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select percent_sales_from_top_20_percent_customers
from "superstore"."dw_student"."mart_pareto_customer_analysis"
where percent_sales_from_top_20_percent_customers is null



  
  
      
    ) dbt_internal_test
[0m20:41:40.113659 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:41:40.117828 [debug] [Thread-1 (]: On test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327: ROLLBACK
[0m20:41:40.118789 [debug] [Thread-1 (]: On test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327: Close
[0m20:41:40.121539 [info ] [Thread-1 (]: 2 of 2 PASS not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers  [[32mPASS[0m in 0.07s]
[0m20:41:40.122332 [debug] [Thread-1 (]: Finished running node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:41:40.125478 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:40.125885 [debug] [MainThread]: On master: BEGIN
[0m20:41:40.126300 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:40.134561 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:41:40.135186 [debug] [MainThread]: On master: COMMIT
[0m20:41:40.135644 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:40.136008 [debug] [MainThread]: On master: COMMIT
[0m20:41:40.136455 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:41:40.136886 [debug] [MainThread]: On master: Close
[0m20:41:40.138695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:40.139097 [debug] [MainThread]: Connection 'test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327' was properly closed.
[0m20:41:40.139564 [info ] [MainThread]: 
[0m20:41:40.139971 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m20:41:40.140820 [debug] [MainThread]: Command end result
[0m20:41:40.163464 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:41:40.165419 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:41:40.172864 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m20:41:40.173469 [info ] [MainThread]: 
[0m20:41:40.175905 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:41:40.176778 [info ] [MainThread]: 
[0m20:41:40.177530 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0 (models/marts/schema.yml)[0m
[0m20:41:40.178091 [error] [MainThread]:   Compilation Error in test dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0 (models/marts/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:41:40.181355 [info ] [MainThread]: 
[0m20:41:40.182001 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m20:41:40.182680 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:41:40.183694 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.054502, "process_in_blocks": "240", "process_kernel_time": 0.147391, "process_mem_max_rss": "120988", "process_out_blocks": "2880", "process_user_time": 1.888832}
[0m20:41:40.184214 [debug] [MainThread]: Command `dbt test` failed at 20:41:40.184091 after 1.06 seconds
[0m20:41:40.184693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b8ea5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b5f42320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320b5f43a30>]}
[0m20:41:40.185116 [debug] [MainThread]: Flushing usage events
[0m20:41:40.861541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:42:28.427018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fb7fa59840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fb7e9f01f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fb7e9f0190>]}


============================== 20:42:28.431067 | 23760c86-9f43-40df-9932-80d6397865eb ==============================
[0m20:42:28.431067 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:42:28.432142 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/dev/.dbt', 'printer_width': '80', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'use_colors': 'True', 'empty': 'None', 'warn_error': 'None', 'debug': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'introspect': 'True', 'invocation_command': 'dbt test --select mart_pareto_customer_analysis', 'no_print': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'version_check': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:42:28.581264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23760c86-9f43-40df-9932-80d6397865eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fb7e994130>]}
[0m20:42:28.633319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23760c86-9f43-40df-9932-80d6397865eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fb7eb80850>]}
[0m20:42:28.634275 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:42:28.712990 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:42:28.824055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:42:28.824593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:42:28.868038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23760c86-9f43-40df-9932-80d6397865eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fb7cfe5c30>]}
[0m20:42:28.948221 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:42:28.950083 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:42:29.011505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23760c86-9f43-40df-9932-80d6397865eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fb7e996980>]}
[0m20:42:29.012119 [info ] [MainThread]: Found 8 models, 11 data tests, 1 source, 435 macros
[0m20:42:29.012896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23760c86-9f43-40df-9932-80d6397865eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fb7e9952d0>]}
[0m20:42:29.014305 [info ] [MainThread]: 
[0m20:42:29.014854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:42:29.015345 [info ] [MainThread]: 
[0m20:42:29.015939 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:42:29.020870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_stg'
[0m20:42:29.053245 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:42:29.053887 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m20:42:29.054304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:29.061851 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:42:29.062438 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:42:29.062816 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m20:42:29.065364 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m20:42:29.066755 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m20:42:29.067692 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m20:42:29.068699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore_stg, now list_superstore_dw_student)
[0m20:42:29.071544 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:42:29.072621 [debug] [ThreadPool]: On list_superstore_dw_student: BEGIN
[0m20:42:29.072970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:29.080434 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:42:29.081093 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:42:29.081590 [debug] [ThreadPool]: On list_superstore_dw_student: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_student"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_student'
  
[0m20:42:29.084540 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:42:29.086118 [debug] [ThreadPool]: On list_superstore_dw_student: ROLLBACK
[0m20:42:29.086868 [debug] [ThreadPool]: On list_superstore_dw_student: Close
[0m20:42:29.092122 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:29.092736 [debug] [MainThread]: On master: BEGIN
[0m20:42:29.093126 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:42:29.100119 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:42:29.100795 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:29.101329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:42:29.105309 [debug] [MainThread]: SQL status: SELECT 13 in 0.003 seconds
[0m20:42:29.108657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23760c86-9f43-40df-9932-80d6397865eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fb7e996980>]}
[0m20:42:29.109257 [debug] [MainThread]: On master: ROLLBACK
[0m20:42:29.110005 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:29.110407 [debug] [MainThread]: On master: BEGIN
[0m20:42:29.111239 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:42:29.111599 [debug] [MainThread]: On master: COMMIT
[0m20:42:29.111913 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:29.112210 [debug] [MainThread]: On master: COMMIT
[0m20:42:29.112736 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:42:29.113086 [debug] [MainThread]: On master: Close
[0m20:42:29.115452 [debug] [Thread-1 (]: Began running node test.student_dwh.dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0.4065b1919f
[0m20:42:29.115975 [info ] [Thread-1 (]: 1 of 2 START test dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0  [RUN]
[0m20:42:29.116686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_dw_student, now test.student_dwh.dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0.4065b1919f)
[0m20:42:29.117257 [debug] [Thread-1 (]: Began compiling node test.student_dwh.dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0.4065b1919f
[0m20:42:29.135689 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0 (models/marts/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:42:29.136789 [error] [Thread-1 (]: 1 of 2 ERROR dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0  [[31mERROR[0m in 0.02s]
[0m20:42:29.137841 [debug] [Thread-1 (]: Finished running node test.student_dwh.dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0.4065b1919f
[0m20:42:29.138476 [debug] [Thread-1 (]: Began running node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:42:29.139124 [debug] [Thread-4 (]: Marking all children of 'test.student_dwh.dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0.4065b1919f' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0 (models/marts/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:42:29.140090 [info ] [Thread-1 (]: 2 of 2 START test not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers  [RUN]
[0m20:42:29.143922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0.4065b1919f, now test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327)
[0m20:42:29.144390 [debug] [Thread-1 (]: Began compiling node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:42:29.153842 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:42:29.154813 [debug] [Thread-1 (]: Began executing node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:42:29.173331 [debug] [Thread-1 (]: Writing runtime sql for node "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:42:29.174674 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:42:29.175156 [debug] [Thread-1 (]: On test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327: BEGIN
[0m20:42:29.175604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:29.183548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:42:29.184253 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:42:29.184649 [debug] [Thread-1 (]: On test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select percent_sales_from_top_20_percent_customers
from "superstore"."dw_student"."mart_pareto_customer_analysis"
where percent_sales_from_top_20_percent_customers is null



  
  
      
    ) dbt_internal_test
[0m20:42:29.185894 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:42:29.191993 [debug] [Thread-1 (]: On test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327: ROLLBACK
[0m20:42:29.193042 [debug] [Thread-1 (]: On test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327: Close
[0m20:42:29.196327 [info ] [Thread-1 (]: 2 of 2 PASS not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers  [[32mPASS[0m in 0.05s]
[0m20:42:29.197923 [debug] [Thread-1 (]: Finished running node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:42:29.199609 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:29.200038 [debug] [MainThread]: On master: BEGIN
[0m20:42:29.200560 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:42:29.208856 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:42:29.209666 [debug] [MainThread]: On master: COMMIT
[0m20:42:29.210117 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:29.210563 [debug] [MainThread]: On master: COMMIT
[0m20:42:29.211115 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:42:29.211554 [debug] [MainThread]: On master: Close
[0m20:42:29.213793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:29.214450 [debug] [MainThread]: Connection 'test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327' was properly closed.
[0m20:42:29.214894 [info ] [MainThread]: 
[0m20:42:29.215665 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m20:42:29.216718 [debug] [MainThread]: Command end result
[0m20:42:29.245088 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:42:29.247831 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:42:29.260946 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m20:42:29.261581 [info ] [MainThread]: 
[0m20:42:29.262460 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:42:29.263063 [info ] [MainThread]: 
[0m20:42:29.263656 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0 (models/marts/schema.yml)[0m
[0m20:42:29.264189 [error] [MainThread]:   Compilation Error in test dbt_utils_accepted_range_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers__100__0 (models/marts/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:42:29.264785 [info ] [MainThread]: 
[0m20:42:29.265321 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m20:42:29.266384 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.89163756, "process_in_blocks": "0", "process_kernel_time": 0.130994, "process_mem_max_rss": "118468", "process_out_blocks": "1968", "process_user_time": 1.692011}
[0m20:42:29.266985 [debug] [MainThread]: Command `dbt test` failed at 20:42:29.266891 after 0.89 seconds
[0m20:42:29.267486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fb7fa59840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fb7d3fff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fb7fc0aec0>]}
[0m20:42:29.268006 [debug] [MainThread]: Flushing usage events
[0m20:42:29.906136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:44:01.115906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744c044bd7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744c0347ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744c0347ce20>]}


============================== 20:44:01.118544 | 51a4c5dc-f844-4ef7-b3ec-1a0168c2e485 ==============================
[0m20:44:01.118544 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:44:01.119095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt test --select mart_pareto_customer_analysis', 'empty': 'None', 'write_json': 'True', 'use_colors': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True', 'quiet': 'False', 'no_print': 'None', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'profiles_dir': '/home/dev/.dbt', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:44:01.266445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a4c5dc-f844-4ef7-b3ec-1a0168c2e485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744c0341f2b0>]}
[0m20:44:01.318653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51a4c5dc-f844-4ef7-b3ec-1a0168c2e485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744c03445390>]}
[0m20:44:01.319603 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:44:01.405163 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:44:01.517014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:44:01.517951 [debug] [MainThread]: Partial parsing: updated file: student_dwh://models/marts/schema.yml
[0m20:44:01.921398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51a4c5dc-f844-4ef7-b3ec-1a0168c2e485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744c0117be50>]}
[0m20:44:01.996389 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:44:01.998517 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:44:02.015512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51a4c5dc-f844-4ef7-b3ec-1a0168c2e485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744c011700d0>]}
[0m20:44:02.016142 [info ] [MainThread]: Found 8 models, 10 data tests, 1 source, 435 macros
[0m20:44:02.016594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a4c5dc-f844-4ef7-b3ec-1a0168c2e485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744c01d68670>]}
[0m20:44:02.017928 [info ] [MainThread]: 
[0m20:44:02.018356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:44:02.018653 [info ] [MainThread]: 
[0m20:44:02.019129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:44:02.023556 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_student'
[0m20:44:02.056690 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:44:02.057210 [debug] [ThreadPool]: On list_superstore_dw_student: BEGIN
[0m20:44:02.057644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:02.074401 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m20:44:02.075824 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:44:02.077525 [debug] [ThreadPool]: On list_superstore_dw_student: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_student"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_student'
  
[0m20:44:02.080308 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:44:02.081659 [debug] [ThreadPool]: On list_superstore_dw_student: ROLLBACK
[0m20:44:02.082512 [debug] [ThreadPool]: On list_superstore_dw_student: Close
[0m20:44:02.086393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore_dw_student, now list_superstore_stg)
[0m20:44:02.090904 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:44:02.092994 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m20:44:02.093631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:02.101136 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:44:02.101769 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:44:02.102153 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m20:44:02.104596 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m20:44:02.105939 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m20:44:02.106602 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m20:44:02.111677 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:02.112123 [debug] [MainThread]: On master: BEGIN
[0m20:44:02.112484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:44:02.118720 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m20:44:02.119264 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:02.119680 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:44:02.122847 [debug] [MainThread]: SQL status: SELECT 13 in 0.003 seconds
[0m20:44:02.126208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a4c5dc-f844-4ef7-b3ec-1a0168c2e485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744c01dd04f0>]}
[0m20:44:02.126717 [debug] [MainThread]: On master: ROLLBACK
[0m20:44:02.127401 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:02.127757 [debug] [MainThread]: On master: BEGIN
[0m20:44:02.128339 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:44:02.128657 [debug] [MainThread]: On master: COMMIT
[0m20:44:02.128981 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:02.129348 [debug] [MainThread]: On master: COMMIT
[0m20:44:02.129814 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:44:02.130139 [debug] [MainThread]: On master: Close
[0m20:44:02.132557 [debug] [Thread-1 (]: Began running node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:44:02.133290 [info ] [Thread-1 (]: 1 of 1 START test not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers  [RUN]
[0m20:44:02.133805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327)
[0m20:44:02.134173 [debug] [Thread-1 (]: Began compiling node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:44:02.150889 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:44:02.151884 [debug] [Thread-1 (]: Began executing node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:44:02.168009 [debug] [Thread-1 (]: Writing runtime sql for node "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:44:02.169202 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:44:02.169785 [debug] [Thread-1 (]: On test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327: BEGIN
[0m20:44:02.170344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:02.178072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:44:02.178778 [debug] [Thread-1 (]: Using postgres connection "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:44:02.179197 [debug] [Thread-1 (]: On test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "node_id": "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select percent_sales_from_top_20_percent_customers
from "superstore"."dw_student"."mart_pareto_customer_analysis"
where percent_sales_from_top_20_percent_customers is null



  
  
      
    ) dbt_internal_test
[0m20:44:02.180787 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:44:02.185407 [debug] [Thread-1 (]: On test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327: ROLLBACK
[0m20:44:02.186464 [debug] [Thread-1 (]: On test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327: Close
[0m20:44:02.187367 [info ] [Thread-1 (]: 1 of 1 PASS not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers  [[32mPASS[0m in 0.05s]
[0m20:44:02.188048 [debug] [Thread-1 (]: Finished running node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:44:02.191838 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:02.192418 [debug] [MainThread]: On master: BEGIN
[0m20:44:02.192756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:44:02.200880 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:44:02.201867 [debug] [MainThread]: On master: COMMIT
[0m20:44:02.202315 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:02.202652 [debug] [MainThread]: On master: COMMIT
[0m20:44:02.203524 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:44:02.203948 [debug] [MainThread]: On master: Close
[0m20:44:02.204510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:02.204848 [debug] [MainThread]: Connection 'test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327' was properly closed.
[0m20:44:02.205167 [info ] [MainThread]: 
[0m20:44:02.205591 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m20:44:02.207257 [debug] [MainThread]: Command end result
[0m20:44:02.243797 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:44:02.246002 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:44:02.260589 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m20:44:02.261140 [info ] [MainThread]: 
[0m20:44:02.261813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:44:02.262181 [info ] [MainThread]: 
[0m20:44:02.262628 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:44:02.263692 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.1939794, "process_in_blocks": "0", "process_kernel_time": 0.168106, "process_mem_max_rss": "123264", "process_out_blocks": "2864", "process_user_time": 1.992821}
[0m20:44:02.264262 [debug] [MainThread]: Command `dbt test` succeeded at 20:44:02.264135 after 1.19 seconds
[0m20:44:02.264701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744c044bd7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744c04736ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744c01976aa0>]}
[0m20:44:02.265355 [debug] [MainThread]: Flushing usage events
[0m20:44:02.945212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:33.732053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7731e3aad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7731e2a60220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7731e2a601c0>]}


============================== 20:47:33.734464 | 90c2e32e-bbb6-42da-894f-8ae816c74c8f ==============================
[0m20:47:33.734464 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:47:33.734997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt docs generate', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/home/dev/.dbt', 'target_path': 'None', 'log_cache_events': 'False', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'empty': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True'}
[0m20:47:33.886694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90c2e32e-bbb6-42da-894f-8ae816c74c8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7731e292a260>]}
[0m20:47:33.936736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90c2e32e-bbb6-42da-894f-8ae816c74c8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7731e32e18a0>]}
[0m20:47:33.937752 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:47:34.007786 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:47:34.120393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:47:34.120991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:47:34.164577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90c2e32e-bbb6-42da-894f-8ae816c74c8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7731e0f21930>]}
[0m20:47:34.177495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90c2e32e-bbb6-42da-894f-8ae816c74c8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7731e1bcacb0>]}
[0m20:47:34.178106 [info ] [MainThread]: Found 8 models, 10 data tests, 1 source, 435 macros
[0m20:47:34.178527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90c2e32e-bbb6-42da-894f-8ae816c74c8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7731e1bcac50>]}
[0m20:47:34.180521 [info ] [MainThread]: 
[0m20:47:34.180919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:47:34.181339 [info ] [MainThread]: 
[0m20:47:34.181815 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:47:34.185855 [debug] [ThreadPool]: Acquiring new postgres connection 'list_superstore_dw_student'
[0m20:47:34.298800 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:47:34.299313 [debug] [ThreadPool]: On list_superstore_dw_student: BEGIN
[0m20:47:34.299625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:34.307045 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:47:34.307804 [debug] [ThreadPool]: Using postgres connection "list_superstore_dw_student"
[0m20:47:34.308262 [debug] [ThreadPool]: On list_superstore_dw_student: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_dw_student"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw_student'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dw_student'
  
[0m20:47:34.311203 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:47:34.312720 [debug] [ThreadPool]: On list_superstore_dw_student: ROLLBACK
[0m20:47:34.313439 [debug] [ThreadPool]: On list_superstore_dw_student: Close
[0m20:47:34.314051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_superstore_dw_student, now list_superstore_stg)
[0m20:47:34.316889 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:47:34.318880 [debug] [ThreadPool]: On list_superstore_stg: BEGIN
[0m20:47:34.319297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:34.328510 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:47:34.329282 [debug] [ThreadPool]: Using postgres connection "list_superstore_stg"
[0m20:47:34.329725 [debug] [ThreadPool]: On list_superstore_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "list_superstore_stg"} */
select
      'superstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
    union all
    select
      'superstore' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'stg'
  
[0m20:47:34.332592 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m20:47:34.334627 [debug] [ThreadPool]: On list_superstore_stg: ROLLBACK
[0m20:47:34.335505 [debug] [ThreadPool]: On list_superstore_stg: Close
[0m20:47:34.340848 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:34.341489 [debug] [MainThread]: On master: BEGIN
[0m20:47:34.341901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:47:34.348482 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m20:47:34.349107 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:34.349541 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:47:34.352637 [debug] [MainThread]: SQL status: SELECT 13 in 0.003 seconds
[0m20:47:34.356369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90c2e32e-bbb6-42da-894f-8ae816c74c8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7731e134fd30>]}
[0m20:47:34.357007 [debug] [MainThread]: On master: ROLLBACK
[0m20:47:34.357630 [debug] [MainThread]: On master: Close
[0m20:47:34.359897 [debug] [Thread-1 (]: Began running node model.student_dwh.calendar_dim
[0m20:47:34.360494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_superstore_stg, now model.student_dwh.calendar_dim)
[0m20:47:34.360868 [debug] [Thread-1 (]: Began compiling node model.student_dwh.calendar_dim
[0m20:47:34.366655 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.calendar_dim"
[0m20:47:34.367569 [debug] [Thread-1 (]: Began executing node model.student_dwh.calendar_dim
[0m20:47:34.368405 [debug] [Thread-1 (]: Finished running node model.student_dwh.calendar_dim
[0m20:47:34.368850 [debug] [Thread-1 (]: Began running node model.student_dwh.stg_orders
[0m20:47:34.369391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.calendar_dim, now model.student_dwh.stg_orders)
[0m20:47:34.369792 [debug] [Thread-1 (]: Began compiling node model.student_dwh.stg_orders
[0m20:47:34.372480 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.stg_orders"
[0m20:47:34.373763 [debug] [Thread-1 (]: Began executing node model.student_dwh.stg_orders
[0m20:47:34.374608 [debug] [Thread-1 (]: Finished running node model.student_dwh.stg_orders
[0m20:47:34.375446 [debug] [Thread-1 (]: Began running node model.student_dwh.customer_dim
[0m20:47:34.375878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.stg_orders, now model.student_dwh.customer_dim)
[0m20:47:34.376277 [debug] [Thread-1 (]: Began compiling node model.student_dwh.customer_dim
[0m20:47:34.378747 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.customer_dim"
[0m20:47:34.379386 [debug] [Thread-1 (]: Began executing node model.student_dwh.customer_dim
[0m20:47:34.380072 [debug] [Thread-1 (]: Finished running node model.student_dwh.customer_dim
[0m20:47:34.380678 [debug] [Thread-1 (]: Began running node model.student_dwh.geo_dim
[0m20:47:34.381523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.customer_dim, now model.student_dwh.geo_dim)
[0m20:47:34.382002 [debug] [Thread-1 (]: Began compiling node model.student_dwh.geo_dim
[0m20:47:34.384765 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.geo_dim"
[0m20:47:34.385749 [debug] [Thread-1 (]: Began executing node model.student_dwh.geo_dim
[0m20:47:34.386544 [debug] [Thread-1 (]: Finished running node model.student_dwh.geo_dim
[0m20:47:34.387074 [debug] [Thread-1 (]: Began running node model.student_dwh.product_dim
[0m20:47:34.387801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.geo_dim, now model.student_dwh.product_dim)
[0m20:47:34.388195 [debug] [Thread-1 (]: Began compiling node model.student_dwh.product_dim
[0m20:47:34.390943 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.product_dim"
[0m20:47:34.391779 [debug] [Thread-1 (]: Began executing node model.student_dwh.product_dim
[0m20:47:34.392558 [debug] [Thread-1 (]: Finished running node model.student_dwh.product_dim
[0m20:47:34.392994 [debug] [Thread-1 (]: Began running node model.student_dwh.shipping_dim
[0m20:47:34.393464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.product_dim, now model.student_dwh.shipping_dim)
[0m20:47:34.393836 [debug] [Thread-1 (]: Began compiling node model.student_dwh.shipping_dim
[0m20:47:34.396727 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.shipping_dim"
[0m20:47:34.397396 [debug] [Thread-1 (]: Began executing node model.student_dwh.shipping_dim
[0m20:47:34.398053 [debug] [Thread-1 (]: Finished running node model.student_dwh.shipping_dim
[0m20:47:34.398461 [debug] [Thread-1 (]: Began running node test.student_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m20:47:34.398841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.shipping_dim, now test.student_dwh.not_null_customer_dim_cust_id.cd86607a42)
[0m20:47:34.399652 [debug] [Thread-1 (]: Began compiling node test.student_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m20:47:34.409693 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.not_null_customer_dim_cust_id.cd86607a42"
[0m20:47:34.410731 [debug] [Thread-1 (]: Began executing node test.student_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m20:47:34.411541 [debug] [Thread-1 (]: Finished running node test.student_dwh.not_null_customer_dim_cust_id.cd86607a42
[0m20:47:34.411974 [debug] [Thread-1 (]: Began running node test.student_dwh.unique_customer_dim_cust_id.4713a3a721
[0m20:47:34.412460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.not_null_customer_dim_cust_id.cd86607a42, now test.student_dwh.unique_customer_dim_cust_id.4713a3a721)
[0m20:47:34.412882 [debug] [Thread-1 (]: Began compiling node test.student_dwh.unique_customer_dim_cust_id.4713a3a721
[0m20:47:34.418045 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.unique_customer_dim_cust_id.4713a3a721"
[0m20:47:34.418908 [debug] [Thread-1 (]: Began executing node test.student_dwh.unique_customer_dim_cust_id.4713a3a721
[0m20:47:34.419695 [debug] [Thread-1 (]: Finished running node test.student_dwh.unique_customer_dim_cust_id.4713a3a721
[0m20:47:34.420067 [debug] [Thread-1 (]: Began running node test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m20:47:34.420506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.unique_customer_dim_cust_id.4713a3a721, now test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d)
[0m20:47:34.420831 [debug] [Thread-1 (]: Began compiling node test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m20:47:34.424056 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d"
[0m20:47:34.424769 [debug] [Thread-1 (]: Began executing node test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m20:47:34.425452 [debug] [Thread-1 (]: Finished running node test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d
[0m20:47:34.425801 [debug] [Thread-1 (]: Began running node test.student_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m20:47:34.426156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.not_null_geo_dim_geo_id.e39e2b473d, now test.student_dwh.unique_geo_dim_geo_id.1203f3ade2)
[0m20:47:34.426589 [debug] [Thread-1 (]: Began compiling node test.student_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m20:47:34.429835 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.unique_geo_dim_geo_id.1203f3ade2"
[0m20:47:34.430701 [debug] [Thread-1 (]: Began executing node test.student_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m20:47:34.431415 [debug] [Thread-1 (]: Finished running node test.student_dwh.unique_geo_dim_geo_id.1203f3ade2
[0m20:47:34.431787 [debug] [Thread-1 (]: Began running node test.student_dwh.not_null_product_dim_prod_id.a7c013c688
[0m20:47:34.432236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.unique_geo_dim_geo_id.1203f3ade2, now test.student_dwh.not_null_product_dim_prod_id.a7c013c688)
[0m20:47:34.432570 [debug] [Thread-1 (]: Began compiling node test.student_dwh.not_null_product_dim_prod_id.a7c013c688
[0m20:47:34.435783 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.not_null_product_dim_prod_id.a7c013c688"
[0m20:47:34.436463 [debug] [Thread-1 (]: Began executing node test.student_dwh.not_null_product_dim_prod_id.a7c013c688
[0m20:47:34.437134 [debug] [Thread-1 (]: Finished running node test.student_dwh.not_null_product_dim_prod_id.a7c013c688
[0m20:47:34.437535 [debug] [Thread-1 (]: Began running node test.student_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m20:47:34.437914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.not_null_product_dim_prod_id.a7c013c688, now test.student_dwh.unique_product_dim_prod_id.c4c4789a7c)
[0m20:47:34.438273 [debug] [Thread-1 (]: Began compiling node test.student_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m20:47:34.441324 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.unique_product_dim_prod_id.c4c4789a7c"
[0m20:47:34.441942 [debug] [Thread-1 (]: Began executing node test.student_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m20:47:34.442622 [debug] [Thread-1 (]: Finished running node test.student_dwh.unique_product_dim_prod_id.c4c4789a7c
[0m20:47:34.442992 [debug] [Thread-1 (]: Began running node model.student_dwh.sales_fact
[0m20:47:34.443390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.unique_product_dim_prod_id.c4c4789a7c, now model.student_dwh.sales_fact)
[0m20:47:34.443731 [debug] [Thread-1 (]: Began compiling node model.student_dwh.sales_fact
[0m20:47:34.446590 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.sales_fact"
[0m20:47:34.447354 [debug] [Thread-1 (]: Began executing node model.student_dwh.sales_fact
[0m20:47:34.447997 [debug] [Thread-1 (]: Finished running node model.student_dwh.sales_fact
[0m20:47:34.448404 [debug] [Thread-1 (]: Began running node test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m20:47:34.450884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.sales_fact, now test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d)
[0m20:47:34.451678 [debug] [Thread-1 (]: Began compiling node test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m20:47:34.455089 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d"
[0m20:47:34.455801 [debug] [Thread-1 (]: Began executing node test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m20:47:34.456523 [debug] [Thread-1 (]: Finished running node test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d
[0m20:47:34.456920 [debug] [Thread-1 (]: Began running node test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m20:47:34.457344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.not_null_shipping_dim_ship_id.0454d0178d, now test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7)
[0m20:47:34.457677 [debug] [Thread-1 (]: Began compiling node test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m20:47:34.460749 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7"
[0m20:47:34.461452 [debug] [Thread-1 (]: Began executing node test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m20:47:34.462065 [debug] [Thread-1 (]: Finished running node test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7
[0m20:47:34.462473 [debug] [Thread-1 (]: Began running node model.student_dwh.mart_pareto_customer_analysis
[0m20:47:34.462832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.unique_shipping_dim_ship_id.98eb2c08a7, now model.student_dwh.mart_pareto_customer_analysis)
[0m20:47:34.463145 [debug] [Thread-1 (]: Began compiling node model.student_dwh.mart_pareto_customer_analysis
[0m20:47:34.466538 [debug] [Thread-1 (]: Writing injected SQL for node "model.student_dwh.mart_pareto_customer_analysis"
[0m20:47:34.467569 [debug] [Thread-1 (]: Began executing node model.student_dwh.mart_pareto_customer_analysis
[0m20:47:34.468325 [debug] [Thread-1 (]: Finished running node model.student_dwh.mart_pareto_customer_analysis
[0m20:47:34.468758 [debug] [Thread-1 (]: Began running node test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m20:47:34.469229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.student_dwh.mart_pareto_customer_analysis, now test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279)
[0m20:47:34.469873 [debug] [Thread-1 (]: Began compiling node test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m20:47:34.476362 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279"
[0m20:47:34.477061 [debug] [Thread-1 (]: Began executing node test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m20:47:34.477734 [debug] [Thread-1 (]: Finished running node test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279
[0m20:47:34.478125 [debug] [Thread-1 (]: Began running node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:47:34.478541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.student_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279, now test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327)
[0m20:47:34.478939 [debug] [Thread-1 (]: Began compiling node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:47:34.482099 [debug] [Thread-1 (]: Writing injected SQL for node "test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327"
[0m20:47:34.482798 [debug] [Thread-1 (]: Began executing node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:47:34.483474 [debug] [Thread-1 (]: Finished running node test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327
[0m20:47:34.484535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:34.484940 [debug] [MainThread]: Connection 'test.student_dwh.not_null_mart_pareto_customer_analysis_percent_sales_from_top_20_percent_customers.0027a6e327' was properly closed.
[0m20:47:34.487127 [debug] [MainThread]: Command end result
[0m20:47:34.576011 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:47:34.578814 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:47:34.585522 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dev/Downloads/pde_magistr/student_dwh/target/run_results.json
[0m20:47:34.590762 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m20:47:34.591312 [info ] [MainThread]: Building catalog
[0m20:47:34.601419 [debug] [ThreadPool]: Acquiring new postgres connection 'superstore.information_schema'
[0m20:47:34.614262 [debug] [ThreadPool]: Using postgres connection "superstore.information_schema"
[0m20:47:34.614848 [debug] [ThreadPool]: On superstore.information_schema: BEGIN
[0m20:47:34.615161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:34.626738 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m20:47:34.627362 [debug] [ThreadPool]: Using postgres connection "superstore.information_schema"
[0m20:47:34.627818 [debug] [ThreadPool]: On superstore.information_schema: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "student_dwh", "target_name": "dev", "connection_name": "superstore.information_schema"} */

    
    

    select
        'superstore' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dw_student') and
           upper(tbl.relname) = upper('customer_dim')) or (upper(sch.nspname) = upper('dw_student') and
           upper(tbl.relname) = upper('mart_pareto_customer_analysis')) or (upper(sch.nspname) = upper('dw_student') and
           upper(tbl.relname) = upper('geo_dim')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('dw_student') and
           upper(tbl.relname) = upper('calendar_dim')) or (upper(sch.nspname) = upper('dw_student') and
           upper(tbl.relname) = upper('sales_fact')) or (upper(sch.nspname) = upper('dw_student') and
           upper(tbl.relname) = upper('shipping_dim')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('dw_student') and
           upper(tbl.relname) = upper('product_dim')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m20:47:34.637056 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.009 seconds
[0m20:47:34.649612 [debug] [ThreadPool]: On superstore.information_schema: ROLLBACK
[0m20:47:34.651428 [debug] [ThreadPool]: On superstore.information_schema: Close
[0m20:47:34.664965 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/dev/Downloads/pde_magistr/student_dwh/target/catalog.json
[0m20:47:34.685397 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/manifest.json
[0m20:47:34.687276 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dev/Downloads/pde_magistr/student_dwh/target/semantic_manifest.json
[0m20:47:34.687808 [info ] [MainThread]: Catalog written to /home/dev/Downloads/pde_magistr/student_dwh/target/catalog.json
[0m20:47:34.689186 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.0053799, "process_in_blocks": "3392", "process_kernel_time": 0.162387, "process_mem_max_rss": "117440", "process_out_blocks": "5568", "process_user_time": 1.873223}
[0m20:47:34.690176 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:47:34.690056 after 1.01 seconds
[0m20:47:34.690741 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:47:34.691042 [debug] [MainThread]: Connection 'superstore.information_schema' was properly closed.
[0m20:47:34.691432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7731e3aad7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7731e13b41c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7731dfa04070>]}
[0m20:47:34.691832 [debug] [MainThread]: Flushing usage events
[0m20:47:35.316737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:02.270737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eea79cbd7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eea78c74d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eea78c74d00>]}


============================== 20:48:02.273430 | 58f7e935-4f89-4bc5-b3ca-06680c3bc93b ==============================
[0m20:48:02.273430 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:48:02.273993 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'quiet': 'False', 'profiles_dir': '/home/dev/.dbt', 'indirect_selection': 'eager', 'log_format': 'default', 'cache_selected_only': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/dev/Downloads/pde_magistr/student_dwh/logs', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True'}
[0m20:48:02.459221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58f7e935-4f89-4bc5-b3ca-06680c3bc93b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eea7b6f53f0>]}
[0m20:48:02.540921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58f7e935-4f89-4bc5-b3ca-06680c3bc93b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eea78c6c310>]}
