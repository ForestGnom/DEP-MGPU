# Лабораторная работа 2.1 Создание dbt-проекта для аналитических витрин

## **Выполнил:** Трухачев Н.А. 
### **Вариант:** 30
### 1. писание архитектуры
Слой intermediate служит для подготовки и преобразования данных после стадии staging, но до финальных витрин. Здесь выполняются сложные джойны, агрегации и бизнес-преобразования, которые являются общими для нескольких витрин. Например, в int_orders_pivoted.sql данные о заказах, трансформируются в удобную для анализа структуру. Это позволяет избежать дублирования логики и повышает переиспользуемость кода.
Слой marts содержит готовые к использованию аналитические витрины, ориентированные на конкретные бизнес-сценарии, такие как анализ продаж (mart_monthly_sales) или расчёт LTV клиентов (mart_customer_ltv). Разделение на intermediate и marts необходимо для соблюдения принципа единой ответственности: промежуточный слой отвечает за техническую подготовку данных, а витрины – за предоставление понятных и целостных бизнес-метрик конечным потребителям (аналитикам, отчетам). 
### 2. [Граф зависимостей (Lineage)](screenshots/Рисунок1.png)
### 3. Ключевые фрагменты кода
- [Код промежуточной модели](superstore_dwh_advanced/models/intermediate/int_sales_orders.sql)
- [Код индивидуальной mart-модели](superstore_dwh_advanced/models/marts/mart_valuable_dormant_customers.sql) 
- [Код кастомного теста](superstore_dwh_advanced/tests/generic/test_is_positive.sql)
- [Код снепшота](superstore_dwh_advanced/snapshots/snapshot_product_dim.sql)
### 4. Результаты (Скриншоты)
- Скриншот успешного выполнения [dbt run](screenshots/Рисунок7.png), [dbt test](screenshots/Рисунок5.png) и [dbt snapshot](screenshots/Рисунок4.png).
- [Скриншот с данными из индивидуальной mart-модели/Запрос](screenshots/Рисунок2.png)
- [Скриншот с данными из индивидуальной mart-модели/Ответ](screenshots/Рисунок3.png)
### 5. Выводы
Использование промежуточных моделей и витрин данных предоставляет ключевое преимущество в виде декомпозиции сложности. Вместо работы с единой громоздкой таблицей фактов, которая содержит всю сырую информацию, сложные бизнес-преобразования разбиваются на управляемые этапы. Промежуточные модели (intermediate) абстрагируют техническую сложность – такие операции, как джойны нескольких таблиц, очистка данных или предварительные агрегации – что делает логику прозрачнее и значительно упрощает тестирование и повторное использование кода.
