# Лабораторная работа 2.1 Создание dbt-проекта для аналитических витрин

## **Выполнил:** Трухачев Н.А. 
### **Вариант:** 30
### Описание архитектуры
Слой intermediate служит для подготовки и преобразования данных после стадии staging, но до финальных витрин. Здесь выполняются сложные джойны, агрегации и бизнес-преобразования, которые являются общими для нескольких витрин. Например, в int_orders_pivoted.sql данные о заказах, трансформируются в удобную для анализа структуру. Это позволяет избежать дублирования логики и повышает переиспользуемость кода.
Слой marts содержит готовые к использованию аналитические витрины, ориентированные на конкретные бизнес-сценарии, такие как анализ продаж (mart_monthly_sales) или расчёт LTV клиентов (mart_customer_ltv). Разделение на intermediate и marts необходимо для соблюдения принципа единой ответственности: промежуточный слой отвечает за техническую подготовку данных, а витрины – за предоставление понятных и целостных бизнес-метрик конечным потребителям (аналитикам, отчетам). 
### [Граф зависимостей (Lineage)](screenshots/Рисунок1.png)


